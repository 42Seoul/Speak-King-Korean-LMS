LMS 시스템 MVP 요구사항 정의서 (v1.4)
1. 프로젝트 개요
목표: 말하기 학습 중심의 LMS 시스템 MVP 구축

핵심 가치: 딜레이 없는 빠른 반복 말하기 학습, 소셜(디스코드/메타버스) 연동을 통한 동기 부여

개발 환경: Next.js (Front/Back), Supabase (DB/Auth/Storage)

운영 원칙: 1인 개발 효율화(유지보수 최소화), 확장성 고려, 클라이언트 중심 로직

2. 사용자 및 권한 (User & Auth)
2.1 회원가입 및 로그인
인증: Supabase Auth 기반 Google 소셜 로그인 단일 지원.

정보 수집: 이메일 주소 (최소화).

절차: 별도 관리자 승인 없이 즉시 가입 및 이용 가능.

2.2 사용자 역할 (Role)
학생 (Student): 수강 신청, 학습 진행, 스프라이트(아바타) 관리, 랭킹 확인.

교사 (Teacher): 콘텐츠 생성/관리, 학생 진도 모니터링, 숙제 할당.

관리자: 시스템 전체 관리 (MVP에서는 교사와 동일 권한 레벨로 처리하되 DB상 구분).

3. 콘텐츠 및 상품 구조 (Content Structure)
3.1 계층 및 관계 구조
Course (강의):

유료 결제 및 상품 관리의 최상위 단위. (예: 3월 기초 회화반)

강의 기간: 상품으로서의 공식 시작일/종료일 존재 (Start Date, End Date).

Enrollment (수강 이력):

학생 개개인의 실제 접근 가능 기간 관리.

학생별 수강 시작/종료일이 Course의 날짜와 다를 수 있음 (중도 합류, 연장 등).

Live Class (라이브 강의):

Course 내에 포함되는 실시간 수업 회차.

각 Class마다 고유한 ZEP 메타버스 접속 링크 보유.

3.2 학습 세트 (Study Set) - 독립형 콘텐츠
구조: Course에 종속되지 않고 독립적으로 존재하며, 목록에서 선택하여 학습.

공개 범위:

Public (공용): 모든 사용자 이용 가능.

Private (개인): 생성자(본인)만 이용 가능 (교사는 학생에게 할당 가능).

3.3 학습 세트 상세 구성 (JSON 데이터)
기본 구성: 텍스트(문장/단어), 뜻(번역), 오디오 파일(필수).

멀티미디어 확장: 각 문장/단어별로 이미지(사진) 또는 **영상(Video)**을 선택적으로 첨부 가능.

저장 방식: Supabase Storage에 미디어 파일 업로드 후, DB에는 JSON 내 URL 형태로 저장.

4. 핵심 기능: 말하기 학습 (Speaking Engine)
4.1 학습 로직 (Client-Side)
엔진: Web Speech API (STT) 활용하여 클라이언트에서 처리 (서버 부하/딜레이 최소화).

판정: 목표 문장 vs 발화 문장 유사도 70% 이상 시 성공 → 즉시 다음 문장 이동.

오디오 재생: 학습 시작 시 audio_url을 통해 원어민 음성 자동 재생.

스킵(Skip): 발화 시도 후 3초 경과 시 버튼 활성화 (강제 이동 가능).

4.2 세션 완료 및 데이터 무결성
완료 기준: 교사가 설정한 **목표 반복 횟수(N회)**를 채워야 **'1 세션 완료'**로 DB 기록. (단순 1회독은 기록 안 됨)

무결성 관리: 클라이언트 위변조 위험 감수. 단, **스킵 비율(총 발화 시도 vs 스킵 횟수)**을 기록하여 어뷰징 유저 식별.

5. 학습 관리 및 숙제 (LMS Logic)
5.1 데이터 저장
콘텐츠: Study_Set 테이블에 JSONB 포맷으로 저장.

진도: User_Study_Progress 테이블에 누적 반복 횟수, 발화 횟수, 스킵 횟수 업데이트 (세션 완료 시점).

5.2 숙제 할당 (Assignment)
교사는 특정 학생에게 특정 Study Set를 할당.

할당 모드:

누적형: "지금까지 총 100번 채워라." (기존 수행 횟수 포함)

신규형: "지금부터 80번 더 해라." (기존 수행 무시, 할당 시점부터 카운트)

6. 학생 페이지 (Student Zone)
Dashboard: 레벨, 스프라이트, 학습 바로가기.

Creative Zone: AI 아바타 생성 및 디스코드 프로필 다운로드 유도.

Ranking:

기준: 단어 점수 + 학습 진도율(반복 횟수).

집계: 주간(Weekly) 단위로 배치(Batch) 처리하여 랭킹 산정.

Social: 디스코드 서버 접속 버튼, ZEP 메타버스 접속 버튼.

7. 교사 페이지 (Teacher Zone)
7.1 실시간 학습 모니터링
기능: 라이브 수업 중 학생들의 현재 학습 상태 확인.

방식: Polling 방식 (1분 간격 자동 데이터 갱신).

표시 정보: 최근 1분 내 활동한 학생 목록, 현재 학습 세트, 금일 누적 반복 횟수.

7.2 관리 기능
Student Management: 수강생 목록, 전체 누적 진도 조회, 숙제 할당.

Content Management: 학습 세트 생성 (오디오/이미지/영상 URL 포함 JSON 입력).

Live Class: 강의 회차별 ZEP 링크 관리.

Course Management: 강의 생성 및 공식 시작/종료일 설정.

8. 향후 개발 계획 (Backlog)
8.1 코스별 일괄 숙제 배정 기능
- 현재는 개별 학생 선택 방식만 지원.
- 추후 'Course' 단위로 학생을 필터링하여 일괄 숙제를 배정하는 기능 추가 필요.
- 위치: 숙제 관리 메뉴 내 '대상 선택' 옵션 확장.
