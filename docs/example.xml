This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.claude/
  settings.local.json
public/
  elevenlabs.html
  google.html
  index.html
src/
  server.js
.env.example
google-credentials.json
package.json
README.md
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".claude/settings.local.json">
{
  "permissions": {
    "allow": [
      "Bash(npm init:*)",
      "Bash(npm install:*)",
      "Bash(mkdir:*)",
      "WebSearch",
      "WebFetch(domain:docs.cloud.google.com)",
      "WebFetch(domain:ai.google.dev)",
      "Bash(npm start)",
      "Bash(pkill:*)"
    ],
    "deny": [],
    "ask": []
  }
}
</file>

<file path="public/elevenlabs.html">
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ì–´ í•™ìŠµ ë¬¸ì¥ ì˜¤ë””ì˜¤ ìƒì„±ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f4f4f4;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 1rem;
            margin-bottom: 2rem;
            border-radius: 10px;
        }
        
        .input-section {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        textarea {
            width: 100%;
            min-height: 200px;
            padding: 1rem;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            resize: vertical;
        }
        
        .button-group {
            margin-top: 1rem;
            text-align: center;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .loading {
            text-align: center;
            margin: 2rem 0;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .results {
            margin-top: 2rem;
        }
        
        .sentence-item {
            background: white;
            margin-bottom: 1rem;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .sentence-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .sentence-number {
            background: #3498db;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .download-btn {
            background: #27ae60;
            font-size: 14px;
            padding: 8px 16px;
        }
        
        .download-btn:hover {
            background: #219a52;
        }
        
        .play-btn {
            background: #f39c12;
            font-size: 14px;
            padding: 8px 16px;
            margin-left: 8px;
        }
        
        .play-btn:hover {
            background: #e67e22;
        }
        
        .play-btn.playing {
            background: #e74c3c;
        }
        
        .play-btn.playing:hover {
            background: #c0392b;
        }
        
        .button-group-result {
            display: flex;
            gap: 8px;
        }
        
        .text-row {
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            border-radius: 5px;
        }
        
        .original { background-color: #fff3cd; }
        .corrected { background-color: #d4edda; }
        .translation { background-color: #e2e3e5; }
        
        .label {
            font-weight: bold;
            color: #666;
            display: inline-block;
            width: 80px;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 0.5rem;
            border-radius: 5px;
            margin-top: 0.5rem;
        }
        
        .download-all {
            background: #e74c3c;
            margin-top: 1rem;
        }
        
        .download-all:hover {
            background: #c0392b;
        }
        
        .voice-settings {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .setting-label {
            font-weight: bold;
            color: #555;
        }
        
        select, input[type="range"] {
            padding: 0.5rem;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .range-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .range-value {
            background: #f8f9fa;
            padding: 0.25rem 0.5rem;
            border-radius: 3px;
            min-width: 40px;
            text-align: center;
            font-size: 12px;
        }
        
        .progress-container {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #3498db;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>í•œêµ­ì–´ í•™ìŠµ ë¬¸ì¥ ì˜¤ë””ì˜¤ ìƒì„±ê¸°</h1>
            <p>í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ë©´ ë§ì¶¤ë²• êµì •, ë²ˆì—­, ìŒì„± ë³€í™˜ì„ ì œê³µí•©ë‹ˆë‹¤</p>
        </header>
        
        <div class="voice-settings">
            <h2>ìŒì„± ì„¤ì •</h2>
            <div class="settings-grid">
                <div class="setting-group">
                    <label class="setting-label" for="voiceSelect">ìŒì„± ì„ íƒ</label>
                    <select id="voiceSelect">
                        <option value="">ë¡œë”© ì¤‘...</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label class="setting-label" for="modelSelect">ëª¨ë¸ ì„ íƒ</label>
                    <select id="modelSelect">
                        <option value="">ë¡œë”© ì¤‘...</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label class="setting-label" for="speedRange">ì†ë„ (0.7x - 1.2x)</label>
                    <div class="range-container">
                        <input type="range" id="speedRange" min="0.7" max="1.2" step="0.05" value="1.0">
                        <span class="range-value" id="speedValue">1.00x</span>
                    </div>
                </div>
                
                <div class="setting-group">
                    <label class="setting-label" for="stabilityRange">ì•ˆì •ì„± (0.0 - 1.0)</label>
                    <div class="range-container">
                        <input type="range" id="stabilityRange" min="0.0" max="1.0" step="0.1" value="0.5">
                        <span class="range-value" id="stabilityValue">0.5</span>
                    </div>
                </div>
                
                <div class="setting-group">
                    <label class="setting-label" for="similarityRange">ìœ ì‚¬ì„± (0.0 - 1.0)</label>
                    <div class="range-container">
                        <input type="range" id="similarityRange" min="0.0" max="1.0" step="0.1" value="0.5">
                        <span class="range-value" id="similarityValue">0.5</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="input-section">
            <h2>ë¬¸ì¥ ì…ë ¥</h2>
            <textarea id="sentenceInput" placeholder="í•œêµ­ì–´ ë¬¸ì¥ë“¤ì„ ì…ë ¥í•˜ì„¸ìš”. ê° ë¬¸ì¥ì€ ìƒˆ ì¤„ì— ì…ë ¥í•´ì£¼ì„¸ìš”.

ì˜ˆì‹œ:
ì•ˆë…• í•˜ì„¸ìš” ì €ëŠ” í•™êµì— ê°ë‹ˆë‹¤
í•œêµ­ì–´ ê³µë¶€ê°€ ì¬ë¯¸ ìˆì–´ìš”
ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì¢‹ë„¤ìš”"></textarea>
            
            <div class="button-group">
                <button id="processBtn" onclick="processSentences()">ë¬¸ì¥ ì²˜ë¦¬í•˜ê¸°</button>
                <button id="clearBtn" onclick="clearAll()">ì´ˆê¸°í™”</button>
            </div>
        </div>
        
        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>ë¬¸ì¥ì„ ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
        </div>
        
        <div id="progress" class="progress-container">
            <div>
                <strong>ì²˜ë¦¬ ì§„í–‰ë¥ </strong>
                <span id="progressText">0 / 0</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        
        <div id="results" class="results"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script>
        let processedData = [];
        let voicesData = null;
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìŒì„± ëª©ë¡ ë¡œë“œ
        document.addEventListener('DOMContentLoaded', async () => {
            await loadVoices();
            setupRangeSliders();
        });
        
        async function loadVoices() {
            try {
                const response = await fetch('/api/voices');
                voicesData = await response.json();
                
                // ìŒì„± ë“œë¡­ë‹¤ìš´ ì±„ìš°ê¸°
                const voiceSelect = document.getElementById('voiceSelect');
                voiceSelect.innerHTML = '<option value="">ê¸°ë³¸ ìŒì„±</option>';
                voicesData.voices.forEach(voice => {
                    const option = document.createElement('option');
                    option.value = voice.id;
                    option.textContent = voice.name;
                    voiceSelect.appendChild(option);
                });
                
                // ëª¨ë¸ ë“œë¡­ë‹¤ìš´ ì±„ìš°ê¸°
                const modelSelect = document.getElementById('modelSelect');
                modelSelect.innerHTML = '';
                voicesData.models.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.id;
                    option.textContent = `${model.name} - ${model.description}`;
                    if (model.id === 'eleven_multilingual_v2') {
                        option.selected = true;
                    }
                    modelSelect.appendChild(option);
                });
                
            } catch (error) {
                console.error('ìŒì„± ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('voiceSelect').innerHTML = '<option value="">ìŒì„± ë¡œë“œ ì‹¤íŒ¨</option>';
                document.getElementById('modelSelect').innerHTML = '<option value="eleven_multilingual_v2">ê¸°ë³¸ ëª¨ë¸</option>';
            }
        }
        
        function setupRangeSliders() {
            const speedRange = document.getElementById('speedRange');
            const speedValue = document.getElementById('speedValue');
            const stabilityRange = document.getElementById('stabilityRange');
            const stabilityValue = document.getElementById('stabilityValue');
            const similarityRange = document.getElementById('similarityRange');
            const similarityValue = document.getElementById('similarityValue');
            
            speedRange.addEventListener('input', () => {
                speedValue.textContent = parseFloat(speedRange.value).toFixed(2) + 'x';
            });
            
            stabilityRange.addEventListener('input', () => {
                stabilityValue.textContent = stabilityRange.value;
            });
            
            similarityRange.addEventListener('input', () => {
                similarityValue.textContent = similarityRange.value;
            });
        }
        
        function getVoiceOptions() {
            return {
                voiceId: document.getElementById('voiceSelect').value || undefined,
                modelId: document.getElementById('modelSelect').value || 'eleven_multilingual_v2',
                speed: parseFloat(document.getElementById('speedRange').value),
                stability: parseFloat(document.getElementById('stabilityRange').value),
                similarityBoost: parseFloat(document.getElementById('similarityRange').value)
            };
        }
        
        async function processSentences() {
            const input = document.getElementById('sentenceInput').value.trim();
            if (!input) {
                alert('ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const sentences = input.split('\n').filter(s => s.trim());
            if (sentences.length === 0) {
                alert('ìœ íš¨í•œ ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const voiceOptions = getVoiceOptions();
            
            document.getElementById('processBtn').disabled = true;
            document.getElementById('loading').style.display = 'block';
            document.getElementById('progress').style.display = 'block';
            document.getElementById('results').innerHTML = '';
            
            // ì§„í–‰ë¥  ì´ˆê¸°í™”
            updateProgress(0, sentences.length);
            
            try {
                const response = await fetch('/api/process-sentences', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        rawSentences: sentences,
                        voiceOptions: voiceOptions 
                    })
                });
                
                if (!response.ok) {
                    throw new Error('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
                
                processedData = await response.json();
                updateProgress(sentences.length, sentences.length);
                displayResults(processedData);
                
            } catch (error) {
                console.error('Error:', error);
                alert('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            } finally {
                document.getElementById('processBtn').disabled = false;
                document.getElementById('loading').style.display = 'none';
                setTimeout(() => {
                    document.getElementById('progress').style.display = 'none';
                }, 2000);
            }
        }
        
        function updateProgress(current, total) {
            const percentage = total > 0 ? (current / total) * 100 : 0;
            document.getElementById('progressText').textContent = `${current} / ${total}`;
            document.getElementById('progressFill').style.width = percentage + '%';
        }
        
        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            let html = '<h2>ì²˜ë¦¬ ê²°ê³¼</h2>';
            
            data.forEach(item => {
                html += `
                    <div class="sentence-item">
                        <div class="sentence-header">
                            <span class="sentence-number">ë¬¸ì¥ ${item.id}</span>
                            ${!item.error ? `
                                <div class="button-group-result">
                                    <button class="play-btn" onclick="playAudio(${item.id}, '${item.binaryData}')" id="playBtn_${item.id}">â–¶ ì¬ìƒ</button>
                                    <button class="download-btn" onclick="downloadAudio(${item.id}, '${item.audioFileName}', '${item.binaryData}')">ë‹¤ìš´ë¡œë“œ</button>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="text-row original">
                            <span class="label">ì›ë¬¸:</span> ${item.original}
                        </div>
                        
                        <div class="text-row corrected">
                            <span class="label">êµì •:</span> ${item.corrected}
                        </div>
                        
                        <div class="text-row translation">
                            <span class="label">ë²ˆì—­:</span> ${item.translation}
                        </div>
                        
                        ${item.error ? `<div class="error">ì˜¤ë¥˜: ${item.error}</div>` : ''}
                    </div>
                `;
            });
            
            if (data.some(item => !item.error)) {
                html += '<div style="text-align: center;"><button class="download-all" onclick="downloadAllAudio()">ëª¨ë“  ì˜¤ë””ì˜¤ ZIP ë‹¤ìš´ë¡œë“œ</button></div>';
            }
            
            resultsDiv.innerHTML = html;
        }
        
        let currentlyPlaying = null;
        
        function playAudio(id, binaryData) {
            try {
                const playBtn = document.getElementById(`playBtn_${id}`);
                
                // ì´ë¯¸ ì¬ìƒ ì¤‘ì¸ ë‹¤ë¥¸ ì˜¤ë””ì˜¤ê°€ ìˆìœ¼ë©´ ì •ì§€
                if (currentlyPlaying && currentlyPlaying !== id) {
                    stopCurrentAudio();
                }
                
                // í˜„ì¬ ì˜¤ë””ì˜¤ê°€ ì¬ìƒ ì¤‘ì´ë©´ ì •ì§€
                if (currentlyPlaying === id) {
                    stopCurrentAudio();
                    return;
                }
                
                const audioBlob = base64ToBlob(binaryData, 'audio/mpeg');
                const url = URL.createObjectURL(audioBlob);
                const audio = new Audio(url);
                
                // ì¬ìƒ ì‹œì‘
                audio.play();
                currentlyPlaying = id;
                playBtn.textContent = 'â¹ ì •ì§€';
                playBtn.classList.add('playing');
                
                // ì¬ìƒ ì™„ë£Œ ì‹œ ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”
                audio.addEventListener('ended', () => {
                    resetPlayButton(id);
                    URL.revokeObjectURL(url);
                });
                
                // ì—ëŸ¬ ì²˜ë¦¬
                audio.addEventListener('error', () => {
                    alert('ì˜¤ë””ì˜¤ ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    resetPlayButton(id);
                    URL.revokeObjectURL(url);
                });
                
                // í˜„ì¬ ì˜¤ë””ì˜¤ ê°ì²´ ì €ì¥
                window[`audio_${id}`] = audio;
                
            } catch (error) {
                alert('ì˜¤ë””ì˜¤ ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                console.error('Play audio error:', error);
            }
        }
        
        function stopCurrentAudio() {
            if (currentlyPlaying) {
                const audio = window[`audio_${currentlyPlaying}`];
                if (audio) {
                    audio.pause();
                    audio.currentTime = 0;
                }
                resetPlayButton(currentlyPlaying);
            }
        }
        
        function resetPlayButton(id) {
            const playBtn = document.getElementById(`playBtn_${id}`);
            if (playBtn) {
                playBtn.textContent = 'â–¶ ì¬ìƒ';
                playBtn.classList.remove('playing');
            }
            currentlyPlaying = null;
        }
        
        function downloadAudio(id, fileName, binaryData) {
            try {
                const audioBlob = base64ToBlob(binaryData, 'audio/mpeg');
                const url = URL.createObjectURL(audioBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = fileName;
                a.click();
                URL.revokeObjectURL(url);
            } catch (error) {
                alert('ì˜¤ë””ì˜¤ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        async function downloadAllAudio() {
            const validItems = processedData.filter(item => !item.error);
            if (validItems.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  ì˜¤ë””ì˜¤ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            try {
                const zip = new JSZip();
                
                // ZIP íŒŒì¼ì— ëª¨ë“  ì˜¤ë””ì˜¤ íŒŒì¼ ì¶”ê°€
                validItems.forEach(item => {
                    const audioBlob = base64ToBlob(item.binaryData, 'audio/mpeg');
                    zip.file(item.audioFileName, audioBlob);
                });
                
                // ë¬¸ì¥ ì •ë³´ë¥¼ ë‹´ì€ í…ìŠ¤íŠ¸ íŒŒì¼ë„ ì¶”ê°€
                let textContent = 'í•œêµ­ì–´ í•™ìŠµ ë¬¸ì¥ ëª©ë¡\n';
                textContent += '='.repeat(50) + '\n\n';
                validItems.forEach(item => {
                    textContent += `${item.id}. ${item.audioFileName}\n`;
                    textContent += `   ì›ë¬¸: ${item.original}\n`;
                    textContent += `   êµì •: ${item.corrected}\n`;
                    textContent += `   ë²ˆì—­: ${item.translation}\n\n`;
                });
                
                zip.file('sentences.txt', textContent);
                
                // ZIP íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
                const zipBlob = await zip.generateAsync({type: 'blob'});
                const url = URL.createObjectURL(zipBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `korean_sentences_${new Date().getTime()}.zip`;
                a.click();
                URL.revokeObjectURL(url);
                
            } catch (error) {
                console.error('ZIP ìƒì„± ì˜¤ë¥˜:', error);
                alert('ZIP íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        function base64ToBlob(base64, mimeType) {
            const byteCharacters = atob(base64);
            const byteNumbers = new Array(byteCharacters.length);
            for (let i = 0; i < byteCharacters.length; i++) {
                byteNumbers[i] = byteCharacters.charCodeAt(i);
            }
            const byteArray = new Uint8Array(byteNumbers);
            return new Blob([byteArray], { type: mimeType });
        }
        
        function clearAll() {
            document.getElementById('sentenceInput').value = '';
            document.getElementById('results').innerHTML = '';
            processedData = [];
        }
    </script>
</body>
</html>
</file>

<file path="public/google.html">
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Cloud TTS - í•œêµ­ì–´ í•™ìŠµ ìŒì„± ìƒì„±ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f4f4f4;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #4285f4, #34a853);
            color: white;
            text-align: center;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-radius: 10px;
            position: relative;
        }
        
        .back-button {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
        }
        
        .back-button:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .service-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        .voice-settings {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .voice-groups {
            margin-bottom: 2rem;
        }
        
        .voice-group {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            margin-bottom: 1rem;
            overflow: hidden;
        }
        
        .voice-group-header {
            background: linear-gradient(45deg, #4285f4, #34a853);
            color: white;
            padding: 1rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .voice-group-header.quality-6 { background: linear-gradient(45deg, #8e44ad, #e74c3c, #f39c12); }
        .voice-group-header.quality-5 { background: linear-gradient(45deg, #ff6b6b, #ee5a24); }
        .voice-group-header.quality-4 { background: linear-gradient(45deg, #4285f4, #34a853); }
        .voice-group-header.quality-3 { background: linear-gradient(45deg, #95a5a6, #7f8c8d); }
        
        .voice-group-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .quality-stars {
            font-size: 0.9rem;
        }
        
        .pricing-badge {
            background: rgba(255,255,255,0.2);
            padding: 0.2rem 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .voice-group-content {
            padding: 1rem;
            display: none;
        }
        
        .voice-group-content.active {
            display: block;
        }
        
        .voice-group-description {
            color: #666;
            margin-bottom: 1rem;
            font-style: italic;
        }
        
        .voice-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
        }
        
        .voice-option {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            padding: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .voice-option:hover {
            border-color: #4285f4;
            background: #f8f9ff;
        }
        
        .voice-option.selected {
            border-color: #4285f4;
            background: #e3f2fd;
        }
        
        .voice-info {
            display: flex;
            flex-direction: column;
        }
        
        .voice-name {
            font-weight: bold;
            color: #333;
        }
        
        .voice-gender {
            font-size: 0.8rem;
            color: #666;
        }
        
        .preview-btn {
            background: #4285f4;
            color: white;
            border: none;
            padding: 0.3rem 0.8rem;
            border-radius: 3px;
            font-size: 0.8rem;
            cursor: pointer;
        }
        
        .preview-btn:hover {
            background: #3367d6;
        }
        
        .pricing-info {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .pricing-title {
            font-weight: bold;
            color: #2e7d32;
            margin-bottom: 0.5rem;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .setting-label {
            font-weight: bold;
            color: #555;
        }
        
        select, input[type="range"], textarea {
            padding: 0.5rem;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .range-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .range-value {
            background: #f8f9fa;
            padding: 0.25rem 0.5rem;
            border-radius: 3px;
            min-width: 60px;
            text-align: center;
            font-size: 12px;
        }
        
        .ssml-section {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .ssml-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: #ddd;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .toggle-switch.active {
            background: #4caf50;
        }
        
        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s;
        }
        
        .toggle-switch.active .toggle-slider {
            transform: translateX(26px);
        }
        
        .ssml-textarea {
            width: 100%;
            min-height: 100px;
            margin-top: 0.5rem;
            font-family: monospace;
            display: none;
        }
        
        .ssml-textarea.active {
            display: block;
        }
        
        .ssml-help {
            font-size: 12px;
            color: #666;
            margin-top: 0.5rem;
        }
        
        .input-section {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        textarea {
            width: 100%;
            min-height: 200px;
            resize: vertical;
        }
        
        .button-group {
            margin-top: 1rem;
            text-align: center;
        }
        
        button {
            background: #4285f4;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 10px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background: #3367d6;
        }
        
        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .loading {
            text-align: center;
            margin: 2rem 0;
            display: none;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4285f4;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .progress-container {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4285f4, #34a853);
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        
        .results {
            margin-top: 2rem;
        }
        
        .sentence-item {
            background: white;
            margin-bottom: 1rem;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .sentence-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .sentence-number {
            background: #4285f4;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .button-group-result {
            display: flex;
            gap: 8px;
        }
        
        .play-btn {
            background: #ff9800;
            font-size: 14px;
            padding: 8px 16px;
        }
        
        .play-btn:hover {
            background: #f57c00;
        }
        
        .play-btn.playing {
            background: #f44336;
        }
        
        .download-btn {
            background: #4caf50;
            font-size: 14px;
            padding: 8px 16px;
        }
        
        .download-btn:hover {
            background: #45a049;
        }
        
        .download-all {
            background: #ff5722;
            margin-top: 1rem;
        }
        
        .download-all:hover {
            background: #e64a19;
        }
        
        .text-row {
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            border-radius: 5px;
        }
        
        .original { background-color: #fff3cd; }
        .corrected { background-color: #d4edda; }
        .translation { background-color: #e2e3e5; }
        
        .label {
            font-weight: bold;
            color: #666;
            display: inline-block;
            width: 80px;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 0.5rem;
            border-radius: 5px;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-button">â† ë©”ì¸ìœ¼ë¡œ</a>
            <div class="service-badge">Google Cloud TTS</div>
            <h1>Google ìŒì„± í•©ì„± ì„œë¹„ìŠ¤</h1>
            <p>êµ¬ê¸€ì˜ Neural2 & WaveNet ê¸°ìˆ ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´ ìŒì„±ì„ ìƒì„±í•˜ì„¸ìš”</p>
        </header>
        
        <div class="voice-settings">
            <h2>ğŸ›ï¸ Google TTS ì„¤ì •</h2>
            
            <!-- ê°€ê²© ì •ë³´ -->
            <div class="pricing-info">
                <div class="pricing-title">ğŸ’° Google TTS ê°€ê²© ì•ˆë‚´</div>
                <div>
                    <strong>ë¬´ë£Œ í• ë‹¹ëŸ‰:</strong> ì›” 100ë§Œ ë¬¸ì (WaveNet/Neural2), ì›” 400ë§Œ ë¬¸ì (Standard)<br>
                    <strong>ìœ ë£Œ ìš”ê¸ˆ:</strong> WaveNet/Neural2 $16/100ë§Œì, Standard $4/100ë§Œì
                </div>
            </div>
            
            <!-- ìŒì„± ê·¸ë£¹ ì„ íƒ -->
            <div class="voice-groups">
                <h3>ğŸ­ ìŒì„± ëª¨ë¸ ì„ íƒ</h3>
                <div id="voiceGroupsContainer">
                    <div class="loading">ìŒì„± ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                </div>
            </div>
            
            <div class="settings-grid">
                
                <div class="setting-group">
                    <label class="setting-label" for="audioEncoding">ì˜¤ë””ì˜¤ í˜•ì‹</label>
                    <select id="audioEncoding">
                        <option value="MP3">MP3 (ê¶Œì¥)</option>
                        <option value="WAV">WAV (ê³ í’ˆì§ˆ)</option>
                        <option value="OGG">OGG (ì••ì¶•)</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label class="setting-label" for="speakingRate">ë§í•˜ê¸° ì†ë„ (0.25x - 4.0x)</label>
                    <div class="range-container">
                        <input type="range" id="speakingRate" min="0.25" max="4.0" step="0.25" value="1.0">
                        <span class="range-value" id="speakingRateValue">1.0x</span>
                    </div>
                </div>
                
                <div class="setting-group">
                    <label class="setting-label" for="pitch">ìŒë†’ì´ (-20 ~ +20)</label>
                    <div class="range-container">
                        <input type="range" id="pitch" min="-20" max="20" step="1" value="0">
                        <span class="range-value" id="pitchValue">0</span>
                    </div>
                </div>
                
                <div class="setting-group">
                    <label class="setting-label" for="volumeGain">ë³¼ë¥¨ (-96dB ~ +16dB)</label>
                    <div class="range-container">
                        <input type="range" id="volumeGain" min="-96" max="16" step="1" value="0">
                        <span class="range-value" id="volumeGainValue">0dB</span>
                    </div>
                </div>
            </div>
            
            <!-- SSML/í”„ë¡¬í”„íŠ¸ ì„¹ì…˜ -->
            <div class="ssml-section" id="advancedSection" style="display: none;">
                <!-- SSML ëª¨ë“œ (Neural2, WaveNet, Standardìš©) -->
                <div id="ssmlMode" style="display: none;">
                    <div class="ssml-toggle">
                        <div class="toggle-switch" id="ssmlToggle">
                            <div class="toggle-slider"></div>
                        </div>
                        <label><strong>ê³ ê¸‰ SSML ëª¨ë“œ</strong> (ê°ì •, ê°•ì¡°, ì¼ì‹œì •ì§€ ë“±)</label>
                    </div>
                    <textarea id="ssmlText" class="ssml-textarea" placeholder="ì˜ˆì‹œ:
<speak>
  ì•ˆë…•í•˜ì„¸ìš”! <break time='1s'/>
  <emphasis level='strong'>ì¤‘ìš”í•œ</emphasis> ë‚´ìš©ì…ë‹ˆë‹¤.
  <prosody rate='slow' pitch='+2st'>ì²œì²œíˆ ë†’ì€ í†¤ìœ¼ë¡œ</prosody>
</speak>"></textarea>
                    <div class="ssml-help">
                        SSML íƒœê·¸: &lt;break time='1s'/&gt; (ì¼ì‹œì •ì§€), &lt;emphasis&gt; (ê°•ì¡°), &lt;prosody rate='slow'&gt; (ì†ë„/ìŒë†’ì´)
                    </div>
                </div>

                <!-- í”„ë¡¬í”„íŠ¸ ëª¨ë“œ (Geminiìš©) -->
                <div id="promptMode" style="display: none;">
                    <label><strong>ğŸ­ ìŒì„± í”„ë¡¬í”„íŠ¸ (ì„ íƒì‚¬í•­)</strong></label>
                    <textarea id="promptText" class="ssml-textarea active" placeholder="ìì—°ì–´ë¡œ ìŒì„± ìŠ¤íƒ€ì¼ì„ ì§€ì‹œí•˜ì„¸ìš”. ë¹„ì›Œë‘ë©´ ê¸°ë³¸ ìŒì„±ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.

ì˜ˆì‹œ:
- ê¸°ì˜ê³  í™œê¸°ì°¬ í†¤ìœ¼ë¡œ ë§í•´ì£¼ì„¸ìš”
- ì°¨ë¶„í•˜ê³  ì§„ì§€í•œ ëª©ì†Œë¦¬ë¡œ ì²œì²œíˆ ì½ì–´ì£¼ì„¸ìš”
- í¥ë¶„ëœ ë“¯í•œ í†¤ìœ¼ë¡œ ë¹ ë¥´ê²Œ ë§í•´ì£¼ì„¸ìš”
- ë”°ëœ»í•˜ê³  ì¹œê·¼í•œ ëª©ì†Œë¦¬ë¡œ ì½ì–´ì£¼ì„¸ìš”
- ì‹ ë¹„ë¡­ê³  ì†ì‚­ì´ëŠ” ë“¯í•œ ëª©ì†Œë¦¬ë¡œ ë§í•´ì£¼ì„¸ìš”"></textarea>
                    <div class="ssml-help">
                        ğŸ’¡ GeminiëŠ” ìì—°ì–´ í”„ë¡¬í”„íŠ¸ë¡œ ìŒì„±ì˜ ìŠ¤íƒ€ì¼, í†¤, ê°ì •, ì†ë„ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        êµ¬ì²´ì ìœ¼ë¡œ ì›í•˜ëŠ” ëŠë‚Œì„ ì„¤ëª…í•˜ë©´ ë” ì •í™•í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </div>
                </div>
            </div>
        </div>

        <div class="input-section">
            <h2>ğŸ“ ë¬¸ì¥ ì…ë ¥</h2>
            <textarea id="sentenceInput" placeholder="í•œêµ­ì–´ ë¬¸ì¥ë“¤ì„ ì…ë ¥í•˜ì„¸ìš”. ê° ë¬¸ì¥ì€ ìƒˆ ì¤„ì— ì…ë ¥í•´ì£¼ì„¸ìš”.

ì˜ˆì‹œ:
ì•ˆë…•í•˜ì„¸ìš”. ì €ëŠ” í•œêµ­ì–´ë¥¼ ë°°ìš°ê³  ìˆìŠµë‹ˆë‹¤.
ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì •ë§ ì¢‹ë„¤ìš”!
êµ¬ê¸€ TTSë¡œ ìì—°ìŠ¤ëŸ¬ìš´ ìŒì„±ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”."></textarea>
            
            <div class="button-group">
                <button id="processBtn" onclick="processSentences()">ğŸµ ìŒì„± ìƒì„±í•˜ê¸°</button>
                <button id="clearBtn" onclick="clearAll()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
            </div>
        </div>
        
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Google TTSë¡œ ìŒì„±ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
        </div>
        
        <div id="progress" class="progress-container">
            <div>
                <strong>ì²˜ë¦¬ ì§„í–‰ë¥ </strong>
                <span id="progressText">0 / 0</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        
        <div id="results" class="results"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script>
        let processedData = [];
        let voicesData = null;
        let currentlyPlaying = null;
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìŒì„± ëª©ë¡ ë¡œë“œ
        document.addEventListener('DOMContentLoaded', async () => {
            await loadVoices();
            setupControls();
        });
        
        let selectedVoiceId = 'Puck'; // Gemini ê¸°ë³¸ ìŒì„±
        
        async function loadVoices() {
            try {
                const response = await fetch('/api/google-voices');
                voicesData = await response.json();
                
                renderVoiceGroups();
                
            } catch (error) {
                console.error('ìŒì„± ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('voiceGroupsContainer').innerHTML = 
                    '<div class="error">ìŒì„± ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
            }
        }
        
        function renderVoiceGroups() {
            const container = document.getElementById('voiceGroupsContainer');
            
            if (!voicesData.voiceGroups) {
                container.innerHTML = '<div class="error">ìŒì„± ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            let html = '';
            
            Object.keys(voicesData.voiceGroups).forEach(groupKey => {
                const group = voicesData.voiceGroups[groupKey];
                const maxStars = 6; // GeminiëŠ” quality 6ê¹Œì§€
                const qualityStars = 'â˜…'.repeat(group.quality) + 'â˜†'.repeat(Math.max(0, maxStars - group.quality));
                
                html += `
                    <div class="voice-group">
                        <div class="voice-group-header quality-${group.quality}" onclick="toggleGroup('${groupKey}')">
                            <div class="voice-group-title">
                                <span>${group.title}</span>
                                <span class="quality-stars">${qualityStars}</span>
                            </div>
                            <span class="pricing-badge">${getPricingText(group.pricing)}</span>
                        </div>
                        <div class="voice-group-content" id="group-${groupKey}">
                            <div class="voice-group-description">${group.description}</div>
                            <div class="voice-grid">
                                ${group.voices.map(voice => `
                                    <div class="voice-option ${voice.id === selectedVoiceId ? 'selected' : ''}"
                                         onclick="selectVoice('${voice.id}')">
                                        <div class="voice-info">
                                            <div class="voice-name">${voice.name}</div>
                                            <div class="voice-gender">${voice.gender === 'FEMALE' ? 'ì—¬ì„±' : voice.gender === 'MALE' ? 'ë‚¨ì„±' : voice.description || 'ì¤‘ë¦½'}</div>
                                        </div>
                                        <button class="preview-btn" onclick="previewVoice('${voice.id}', event)">ë¯¸ë¦¬ë“£ê¸°</button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;

            // Gemini ê·¸ë£¹ì„ ê¸°ë³¸ìœ¼ë¡œ ì—´ê¸°
            document.getElementById('group-gemini').classList.add('active');

            // ê¸°ë³¸ ìŒì„±(Puck)ì— ëŒ€í•œ UI ì—…ë°ì´íŠ¸
            updateAdvancedSection();
        }
        
        function getPricingText(pricing) {
            switch(pricing) {
                case 'ultra': return 'ìš¸íŠ¸ë¼';
                case 'premium': return 'í”„ë¦¬ë¯¸ì—„';
                case 'high': return 'ê³ ê°€';
                case 'low': return 'ì €ê°€';
                default: return pricing;
            }
        }
        
        function toggleGroup(groupKey) {
            const content = document.getElementById(`group-${groupKey}`);
            content.classList.toggle('active');
        }
        
        function selectVoice(voiceId) {
            // ì´ì „ ì„ íƒ í•´ì œ
            document.querySelectorAll('.voice-option').forEach(el => {
                el.classList.remove('selected');
            });

            // ìƒˆ ì„ íƒ ì ìš©
            event.target.closest('.voice-option').classList.add('selected');
            selectedVoiceId = voiceId;

            console.log(`Selected voice: ${voiceId}`);

            // ì„ íƒí•œ ìŒì„±ì´ Geminiì¸ì§€ í™•ì¸í•˜ê³  UI ì „í™˜
            updateAdvancedSection();
        }

        function updateAdvancedSection() {
            const advancedSection = document.getElementById('advancedSection');
            const ssmlMode = document.getElementById('ssmlMode');
            const promptMode = document.getElementById('promptMode');

            // Gemini ìŒì„±ì¸ì§€ í™•ì¸
            const isGeminiVoice = selectedVoiceId && !selectedVoiceId.includes('ko-KR-');

            if (isGeminiVoice) {
                // Gemini: í”„ë¡¬í”„íŠ¸ ëª¨ë“œ í‘œì‹œ
                advancedSection.style.display = 'block';
                ssmlMode.style.display = 'none';
                promptMode.style.display = 'block';
            } else if (selectedVoiceId && selectedVoiceId.includes('ko-KR-')) {
                // Google TTS (Neural2, WaveNet, Standard): SSML ëª¨ë“œ í‘œì‹œ
                advancedSection.style.display = 'block';
                ssmlMode.style.display = 'block';
                promptMode.style.display = 'none';
            } else {
                // ìŒì„± ë¯¸ì„ íƒ ì‹œ ìˆ¨ê¹€
                advancedSection.style.display = 'none';
            }
        }
        
        async function previewVoice(voiceId, event) {
            event.stopPropagation();

            const button = event.target;
            const originalText = button.textContent;
            const isGeminiVoice = !voiceId.includes('ko-KR-');

            try {
                button.textContent = 'ìƒì„±ì¤‘...';
                button.disabled = true;

                let audioData;

                if (isGeminiVoice) {
                    // Gemini ìŒì„±: process-sentences ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš©
                    const voiceOptions = {
                        voiceName: voiceId,
                        modelName: 'gemini-2.5-pro-tts',
                        voicePrompt: null,
                        languageCode: 'ko-KR',
                        audioEncoding: 'MP3'
                    };

                    const response = await fetch('/api/google-process-sentences', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            rawSentences: ["ì•ˆë…•í•˜ì„¸ìš”. ì´ê²ƒì€ ìŒì„± ë¯¸ë¦¬ë³´ê¸°ì…ë‹ˆë‹¤."],
                            voiceOptions: voiceOptions
                        })
                    });

                    if (!response.ok) {
                        throw new Error('ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì‹¤íŒ¨');
                    }

                    const results = await response.json();
                    if (results[0] && results[0].binaryData) {
                        audioData = results[0].binaryData;
                    } else if (results[0] && results[0].error) {
                        throw new Error(results[0].error);
                    } else {
                        throw new Error('ì˜¤ë””ì˜¤ ë°ì´í„° ì—†ìŒ');
                    }
                } else {
                    // Google TTS ìŒì„±: preview ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš©
                    const response = await fetch('/api/google-preview', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            voiceId: voiceId,
                            previewText: "ì•ˆë…•í•˜ì„¸ìš”. ì´ê²ƒì€ ìŒì„± ë¯¸ë¦¬ë³´ê¸°ì…ë‹ˆë‹¤."
                        })
                    });

                    if (!response.ok) {
                        throw new Error('ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì‹¤íŒ¨');
                    }

                    const result = await response.json();
                    audioData = result.audioData;
                }

                // ì˜¤ë””ì˜¤ ì¬ìƒ
                const audioBlob = base64ToBlob(audioData, 'audio/mpeg');
                const url = URL.createObjectURL(audioBlob);
                const audio = new Audio(url);

                // í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ì˜¤ë””ì˜¤ê°€ ìˆìœ¼ë©´ ì •ì§€
                if (currentlyPlaying) {
                    stopCurrentAudio();
                }

                button.textContent = 'ì¬ìƒì¤‘...';
                audio.play();

                audio.addEventListener('ended', () => {
                    button.textContent = originalText;
                    button.disabled = false;
                    URL.revokeObjectURL(url);
                });

                audio.addEventListener('error', () => {
                    button.textContent = originalText;
                    button.disabled = false;
                    URL.revokeObjectURL(url);
                    alert('ì˜¤ë””ì˜¤ ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });

            } catch (error) {
                console.error('Preview error:', error);
                alert('ìŒì„± ë¯¸ë¦¬ë³´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        function setupControls() {
            // ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ ì„¤ì •
            const speakingRate = document.getElementById('speakingRate');
            const speakingRateValue = document.getElementById('speakingRateValue');
            const pitch = document.getElementById('pitch');
            const pitchValue = document.getElementById('pitchValue');
            const volumeGain = document.getElementById('volumeGain');
            const volumeGainValue = document.getElementById('volumeGainValue');
            
            speakingRate.addEventListener('input', () => {
                speakingRateValue.textContent = speakingRate.value + 'x';
            });
            
            pitch.addEventListener('input', () => {
                pitchValue.textContent = pitch.value;
            });
            
            volumeGain.addEventListener('input', () => {
                volumeGainValue.textContent = volumeGain.value + 'dB';
            });
            
            // SSML í† ê¸€ ì„¤ì •
            const ssmlToggle = document.getElementById('ssmlToggle');
            const ssmlTextarea = document.getElementById('ssmlText');
            
            ssmlToggle.addEventListener('click', () => {
                ssmlToggle.classList.toggle('active');
                ssmlTextarea.classList.toggle('active');
            });
        }
        
        function getVoiceOptions() {
            const voiceName = selectedVoiceId || 'ko-KR-Neural2-A';
            const isGeminiVoice = !voiceName.includes('ko-KR-');

            if (isGeminiVoice) {
                // Gemini ìŒì„±: í”„ë¡¬í”„íŠ¸ ëª¨ë“œ
                const promptText = document.getElementById('promptText').value.trim();

                return {
                    voiceName: voiceName,
                    modelName: 'gemini-2.5-pro-tts',
                    voicePrompt: promptText || null,
                    languageCode: 'ko-KR',
                    audioEncoding: 'MP3'
                };
            } else {
                // Google TTS ìŒì„±: SSML ëª¨ë“œ
                const ssmlToggle = document.getElementById('ssmlToggle');
                const ssmlText = document.getElementById('ssmlText').value.trim();

                return {
                    voiceName: voiceName,
                    audioEncoding: document.getElementById('audioEncoding').value || 'MP3',
                    speakingRate: parseFloat(document.getElementById('speakingRate').value),
                    pitch: parseFloat(document.getElementById('pitch').value),
                    volumeGainDb: parseFloat(document.getElementById('volumeGain').value),
                    languageCode: 'ko-KR',
                    ssmlGender: selectedVoiceId && (selectedVoiceId.includes('B') || selectedVoiceId.includes('D')) ? 'MALE' : 'FEMALE',
                    ssmlText: ssmlToggle.classList.contains('active') && ssmlText ? ssmlText : null
                };
            }
        }
        
        async function processSentences() {
            const input = document.getElementById('sentenceInput').value.trim();
            if (!input) {
                alert('ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const sentences = input.split('\n').filter(s => s.trim());
            if (sentences.length === 0) {
                alert('ìœ íš¨í•œ ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const voiceOptions = getVoiceOptions();
            
            document.getElementById('processBtn').disabled = true;
            document.getElementById('loading').style.display = 'block';
            document.getElementById('progress').style.display = 'block';
            document.getElementById('results').innerHTML = '';
            
            updateProgress(0, sentences.length);
            
            try {
                const response = await fetch('/api/google-process-sentences', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        rawSentences: sentences,
                        voiceOptions: voiceOptions 
                    })
                });
                
                if (!response.ok) {
                    throw new Error('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
                
                processedData = await response.json();
                updateProgress(sentences.length, sentences.length);
                displayResults(processedData);
                
            } catch (error) {
                console.error('Error:', error);
                alert('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            } finally {
                document.getElementById('processBtn').disabled = false;
                document.getElementById('loading').style.display = 'none';
                setTimeout(() => {
                    document.getElementById('progress').style.display = 'none';
                }, 2000);
            }
        }
        
        function updateProgress(current, total) {
            const percentage = total > 0 ? (current / total) * 100 : 0;
            document.getElementById('progressText').textContent = `${current} / ${total}`;
            document.getElementById('progressFill').style.width = percentage + '%';
        }
        
        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            let html = '<h2>ğŸµ ì²˜ë¦¬ ê²°ê³¼</h2>';
            
            data.forEach(item => {
                html += `
                    <div class="sentence-item">
                        <div class="sentence-header">
                            <span class="sentence-number">ë¬¸ì¥ ${item.id}</span>
                            ${!item.error ? `
                                <div class="button-group-result">
                                    <button class="play-btn" onclick="playAudio(${item.id}, '${item.binaryData}')" id="playBtn_${item.id}">â–¶ ì¬ìƒ</button>
                                    <button class="download-btn" onclick="downloadAudio(${item.id}, '${item.audioFileName}', '${item.binaryData}')">ë‹¤ìš´ë¡œë“œ</button>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="text-row original">
                            <span class="label">ì›ë¬¸:</span> ${item.original}
                        </div>
                        
                        <div class="text-row corrected">
                            <span class="label">êµì •:</span> ${item.corrected}
                        </div>
                        
                        <div class="text-row translation">
                            <span class="label">ë²ˆì—­:</span> ${item.translation}
                        </div>
                        
                        ${item.error ? `<div class="error">ì˜¤ë¥˜: ${item.error}</div>` : ''}
                    </div>
                `;
            });
            
            if (data.some(item => !item.error)) {
                html += '<div style="text-align: center;"><button class="download-all" onclick="downloadAllAudio()">ëª¨ë“  ì˜¤ë””ì˜¤ ZIP ë‹¤ìš´ë¡œë“œ</button></div>';
            }
            
            resultsDiv.innerHTML = html;
        }
        
        function playAudio(id, binaryData) {
            try {
                const playBtn = document.getElementById(`playBtn_${id}`);
                
                if (currentlyPlaying && currentlyPlaying !== id) {
                    stopCurrentAudio();
                }
                
                if (currentlyPlaying === id) {
                    stopCurrentAudio();
                    return;
                }
                
                const audioBlob = base64ToBlob(binaryData, 'audio/mpeg');
                const url = URL.createObjectURL(audioBlob);
                const audio = new Audio(url);
                
                audio.play();
                currentlyPlaying = id;
                playBtn.textContent = 'â¹ ì •ì§€';
                playBtn.classList.add('playing');
                
                audio.addEventListener('ended', () => {
                    resetPlayButton(id);
                    URL.revokeObjectURL(url);
                });
                
                audio.addEventListener('error', () => {
                    alert('ì˜¤ë””ì˜¤ ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    resetPlayButton(id);
                    URL.revokeObjectURL(url);
                });
                
                window[`audio_${id}`] = audio;
                
            } catch (error) {
                alert('ì˜¤ë””ì˜¤ ì¬ìƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                console.error('Play audio error:', error);
            }
        }
        
        function stopCurrentAudio() {
            if (currentlyPlaying) {
                const audio = window[`audio_${currentlyPlaying}`];
                if (audio) {
                    audio.pause();
                    audio.currentTime = 0;
                }
                resetPlayButton(currentlyPlaying);
            }
        }
        
        function resetPlayButton(id) {
            const playBtn = document.getElementById(`playBtn_${id}`);
            if (playBtn) {
                playBtn.textContent = 'â–¶ ì¬ìƒ';
                playBtn.classList.remove('playing');
            }
            currentlyPlaying = null;
        }
        
        function downloadAudio(id, fileName, binaryData) {
            try {
                const audioBlob = base64ToBlob(binaryData, 'audio/mpeg');
                const url = URL.createObjectURL(audioBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = fileName;
                a.click();
                URL.revokeObjectURL(url);
            } catch (error) {
                alert('ì˜¤ë””ì˜¤ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        async function downloadAllAudio() {
            const validItems = processedData.filter(item => !item.error);
            if (validItems.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  ì˜¤ë””ì˜¤ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            try {
                const zip = new JSZip();
                
                validItems.forEach(item => {
                    const audioBlob = base64ToBlob(item.binaryData, 'audio/mpeg');
                    zip.file(item.audioFileName, audioBlob);
                });
                
                let textContent = 'Google TTS í•œêµ­ì–´ í•™ìŠµ ë¬¸ì¥ ëª©ë¡\n';
                textContent += '='.repeat(50) + '\n\n';
                validItems.forEach(item => {
                    textContent += `${item.id}. ${item.audioFileName}\n`;
                    textContent += `   ì›ë¬¸: ${item.original}\n`;
                    textContent += `   êµì •: ${item.corrected}\n`;
                    textContent += `   ë²ˆì—­: ${item.translation}\n\n`;
                });
                
                zip.file('sentences.txt', textContent);
                
                const zipBlob = await zip.generateAsync({type: 'blob'});
                const url = URL.createObjectURL(zipBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `google_tts_korean_sentences_${new Date().getTime()}.zip`;
                a.click();
                URL.revokeObjectURL(url);
                
            } catch (error) {
                console.error('ZIP ìƒì„± ì˜¤ë¥˜:', error);
                alert('ZIP íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        function base64ToBlob(base64, mimeType) {
            const byteCharacters = atob(base64);
            const byteNumbers = new Array(byteCharacters.length);
            for (let i = 0; i < byteCharacters.length; i++) {
                byteNumbers[i] = byteCharacters.charCodeAt(i);
            }
            const byteArray = new Uint8Array(byteNumbers);
            return new Blob([byteArray], { type: mimeType });
        }
        
        function clearAll() {
            document.getElementById('sentenceInput').value = '';
            document.getElementById('results').innerHTML = '';
            processedData = [];
        }
    </script>
</body>
</html>
</file>

<file path="public/index.html">
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ì–´ í•™ìŠµ ìŒì„± ìƒì„±ê¸° - ì„œë¹„ìŠ¤ ì„ íƒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
        }
        
        header {
            text-align: center;
            color: white;
            margin-bottom: 3rem;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .service-card {
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            border-radius: 20px 20px 0 0;
        }
        
        .elevenlabs-card::before {
            background: linear-gradient(90deg, #ff6b6b, #ee5a24);
        }
        
        .google-card::before {
            background: linear-gradient(90deg, #4285f4, #34a853, #fbbc05, #ea4335);
        }
        
        .service-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
        }
        
        .elevenlabs-icon {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
        }
        
        .google-icon {
            background: linear-gradient(45deg, #4285f4, #34a853);
            color: white;
        }
        
        .service-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .service-description {
            font-size: 1rem;
            color: #666;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }
        
        .service-features {
            list-style: none;
            text-align: left;
            margin-bottom: 2rem;
        }
        
        .service-features li {
            padding: 0.5rem 0;
            color: #555;
            position: relative;
            padding-left: 1.5rem;
        }
        
        .service-features li::before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: #27ae60;
            font-weight: bold;
        }
        
        .service-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-weight: bold;
        }
        
        .service-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .elevenlabs-button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }
        
        .google-button {
            background: linear-gradient(45deg, #4285f4, #34a853);
        }
        
        .badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #e74c3c;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .new-badge {
            background: #e74c3c;
        }
        
        .premium-badge {
            background: #f39c12;
        }
        
        footer {
            text-align: center;
            margin-top: 3rem;
            color: white;
            opacity: 0.8;
        }
        
        @media (max-width: 768px) {
            .services-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .service-card {
                padding: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>í•œêµ­ì–´ í•™ìŠµ ìŒì„± ìƒì„±ê¸°</h1>
            <p class="subtitle">ê³ í’ˆì§ˆ AI ìŒì„±ìœ¼ë¡œ í•œêµ­ì–´ í•™ìŠµì„ ë”ìš± íš¨ê³¼ì ìœ¼ë¡œ</p>
        </header>
        
        <div class="services-grid">
            <!-- ElevenLabs Card -->
            <div class="service-card elevenlabs-card" onclick="selectService('elevenlabs')">
                <div class="badge premium-badge">PREMIUM</div>
                <div class="service-icon elevenlabs-icon">ğŸ™ï¸</div>
                <h2 class="service-title">ElevenLabs</h2>
                <p class="service-description">
                    ì„¸ê³„ ìµœê³  í’ˆì§ˆì˜ AI ìŒì„± ìƒì„± ì„œë¹„ìŠ¤. ìì—°ìŠ¤ëŸ½ê³  ê°ì •ì´ í’ë¶€í•œ ìŒì„±ì„ ì œê³µí•©ë‹ˆë‹¤.
                </p>
                <ul class="service-features">
                    <li>ì´ˆê³ í’ˆì§ˆ ìì—°ìŠ¤ëŸ¬ìš´ ìŒì„±</li>
                    <li>ë‹¤ì–‘í•œ ìŒì„± ìŠ¤íƒ€ì¼ ì„ íƒ</li>
                    <li>ì‹¤ì‹œê°„ ìŒì„± ì†ë„ ì¡°ì ˆ</li>
                    <li>70ê°œ ì´ìƒ ì–¸ì–´ ì§€ì›</li>
                    <li>ê°ì • í‘œí˜„ ë° ì–µì–‘ ì¡°ì ˆ</li>
                </ul>
                <a href="elevenlabs.html" class="service-button elevenlabs-button">ElevenLabsë¡œ ì‹œì‘í•˜ê¸°</a>
            </div>
            
            <!-- Google TTS Card -->
            <div class="service-card google-card" onclick="selectService('google')">
                <div class="badge new-badge">NEW</div>
                <div class="service-icon google-icon">ğŸŒ</div>
                <h2 class="service-title">Google Cloud TTS</h2>
                <p class="service-description">
                    êµ¬ê¸€ì˜ ê°•ë ¥í•œ í´ë¼ìš°ë“œ ê¸°ë°˜ ìŒì„± í•©ì„± ê¸°ìˆ . ì•ˆì •ì ì´ê³  ê²½ì œì ì¸ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
                </p>
                <ul class="service-features">
                    <li>WaveNet & Neural2 ê³ í’ˆì§ˆ ìŒì„±</li>
                    <li>SSML ë§ˆí¬ì—… ì§€ì›</li>
                    <li>ê²½ì œì ì¸ ê°€ê²© ì •ì±…</li>
                    <li>êµ¬ê¸€ í´ë¼ìš°ë“œ ì‹ ë¢°ì„±</li>
                    <li>ì»¤ìŠ¤í…€ ìŒì„± ëª¨ë¸ ì§€ì›</li>
                </ul>
                <a href="google.html" class="service-button google-button">Google TTSë¡œ ì‹œì‘í•˜ê¸°</a>
            </div>
        </div>
        
        <footer>
            <p>Â© 2024 í•œêµ­ì–´ í•™ìŠµ ìŒì„± ìƒì„±ê¸°. AI ê¸°ìˆ ë¡œ ë” ë‚˜ì€ í•™ìŠµ ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
        </footer>
    </div>
    
    <script>
        function selectService(service) {
            // ì„œë¹„ìŠ¤ ì„ íƒ ì €ì¥
            localStorage.setItem('preferredTTSService', service);
            
            // í˜ì´ì§€ ì´ë™ (í´ë¦­ ì´ë²¤íŠ¸ê°€ a íƒœê·¸ë¡œ ì²˜ë¦¬ë¨)
            console.log(`Selected service: ${service}`);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ì „ ì„ íƒ í‘œì‹œ
        document.addEventListener('DOMContentLoaded', () => {
            const preferred = localStorage.getItem('preferredTTSService');
            if (preferred) {
                console.log(`Previously selected: ${preferred}`);
            }
        });
    </script>
</body>
</html>
</file>

<file path="src/server.js">
require('dotenv').config();
const express = require('express');
const cors = require('cors');
const axios = require('axios');
const path = require('path');
const textToSpeech = require('@google-cloud/text-to-speech');
const { GoogleGenerativeAI } = require('@google/generative-ai');

const app = express();
const PORT = process.env.PORT || 3000;

app.use(cors());
app.use(express.json());
app.use(express.static(path.join(__dirname, '../public')));

const spellCheck = async (text) => {
  // ë§ì¶¤ë²• ê²€ì‚¬ ë¹„í™œì„±í™” - íƒ€ì„ì•„ì›ƒ ì˜¤ë¥˜ë¡œ ì¸í•´ ì›ë³¸ í…ìŠ¤íŠ¸ ë°˜í™˜
  console.log('[Spell Check] Skipping spell check due to timeout issues');
  return text;
};

const translateText = async (text, targetLang = 'en', retryCount = 0) => {
  const maxRetries = 2;
  
  // ì²« ë²ˆì§¸ API: MyMemory
  try {
    const response = await axios.post('https://api.mymemory.translated.net/get', null, {
      params: {
        q: text,
        langpair: 'ko|en'
      },
      timeout: 5000
    });
    
    const translatedText = response.data.responseData.translatedText;
    if (translatedText && translatedText.toLowerCase() !== text.toLowerCase()) {
      return translatedText;
    }
  } catch (error) {
    console.warn('MyMemory translation failed:', error.message);
  }

  // ëŒ€ì²´ API: LibreTranslate (ë¬´ë£Œ)
  try {
    const response = await axios.post('https://libretranslate.de/translate', {
      q: text,
      source: 'ko',
      target: 'en',
      format: 'text'
    }, {
      headers: {
        'Content-Type': 'application/json'
      },
      timeout: 5000
    });
    
    if (response.data.translatedText) {
      return response.data.translatedText;
    }
  } catch (error) {
    console.warn('LibreTranslate failed:', error.message);
  }

  // ë§ˆì§€ë§‰ ëŒ€ì²´: ê°„ë‹¨í•œ ë¡œì»¬ ì²˜ë¦¬
  try {
    const response = await axios.get('https://api.mymemory.translated.net/get', {
      params: {
        q: text,
        langpair: 'ko|en'
      },
      timeout: 3000
    });
    
    return response.data.responseData.translatedText || text;
  } catch (error) {
    console.error('All translation services failed:', error.message);
    return `[ë²ˆì—­ ì‹¤íŒ¨] ${text}`;
  }
};

const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));

// Google Cloud TTS í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
let googleTTSClient = null;
let googleAPIKey = null;
let useRestAPI = false;

const initGoogleTTS = () => {
  try {
    // ì—¬ëŸ¬ ì¸ì¦ ë°©ë²• ì‹œë„
    if (process.env.GOOGLE_APPLICATION_CREDENTIALS) {
      // ë°©ë²• 1: ì„œë¹„ìŠ¤ ê³„ì • í‚¤ íŒŒì¼
      googleTTSClient = new textToSpeech.TextToSpeechClient({
        keyFilename: process.env.GOOGLE_APPLICATION_CREDENTIALS
      });
      console.log('[Google TTS] Client initialized with service account key');
      useRestAPI = false;
    } else if (process.env.GOOGLE_API_KEY) {
      // ë°©ë²• 2: API í‚¤ ì‚¬ìš© (REST APIë¡œ ì§ì ‘ í˜¸ì¶œ)
      googleAPIKey = process.env.GOOGLE_API_KEY;
      useRestAPI = true;
      console.log('[Google TTS] Using REST API with API key');
    } else if (process.env.GOOGLE_CLOUD_PROJECT) {
      // ë°©ë²• 3: í”„ë¡œì íŠ¸ ID + ê¸°ë³¸ ì¸ì¦ (gcloud)
      googleTTSClient = new textToSpeech.TextToSpeechClient({
        projectId: process.env.GOOGLE_CLOUD_PROJECT
      });
      console.log('[Google TTS] Client initialized with project ID');
      useRestAPI = false;
    } else {
      console.warn('[Google TTS] No credentials found - Google TTS will be disabled');
      console.warn('Set GOOGLE_APPLICATION_CREDENTIALS, GOOGLE_API_KEY, or GOOGLE_CLOUD_PROJECT in .env');
    }
  } catch (error) {
    console.error('[Google TTS] Failed to initialize:', error.message);
    googleTTSClient = null;
  }
};

// ì„œë²„ ì‹œì‘ ì‹œ Google TTS ì´ˆê¸°í™”
initGoogleTTS();

const generateGoogleTTS = async (text, options = {}) => {
  if (!googleTTSClient && !useRestAPI) {
    throw new Error('Google TTS not configured. Please set GOOGLE_APPLICATION_CREDENTIALS, GOOGLE_API_KEY, or GOOGLE_CLOUD_PROJECT environment variable.');
  }

  const {
    languageCode = 'ko-KR',
    voiceName = 'ko-KR-Neural2-A',
    ssmlGender = 'FEMALE',
    speakingRate = 1.0,
    pitch = 0.0,
    volumeGainDb = 0.0,
    audioEncoding = 'MP3',
    ssmlText = null
  } = options;

  console.log(`[Google TTS] Generating audio for: "${text}"`);
  console.log(`[Google TTS] Settings:`, {
    languageCode,
    voiceName,
    ssmlGender,
    speakingRate,
    pitch,
    volumeGainDb
  });

  try {
    const request = {
      input: ssmlText ? { ssml: ssmlText } : { text: text },
      voice: {
        languageCode: languageCode,
        name: voiceName,
        ssmlGender: ssmlGender,
      },
      audioConfig: {
        audioEncoding: audioEncoding,
        speakingRate: Math.max(0.25, Math.min(4.0, speakingRate)),
        pitch: Math.max(-20.0, Math.min(20.0, pitch)),
        volumeGainDb: Math.max(-96.0, Math.min(16.0, volumeGainDb)),
      },
    };

    if (useRestAPI) {
      // REST API ì‚¬ìš©
      const response = await axios.post(
        `https://texttospeech.googleapis.com/v1/text:synthesize?key=${googleAPIKey}`,
        request,
        {
          headers: {
            'Content-Type': 'application/json',
          },
          timeout: 30000
        }
      );

      console.log(`[Google TTS] Success (REST API) - Audio received`);
      return Buffer.from(response.data.audioContent, 'base64');
    } else {
      // Node.js í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©
      const [response] = await googleTTSClient.synthesizeSpeech(request);
      console.log(`[Google TTS] Success - Audio size: ${response.audioContent.length} bytes`);
      return response.audioContent;
    }
  } catch (error) {
    console.error('[Google TTS] Error:', error.message);
    if (error.response?.data) {
      console.error('[Google TTS] Error details:', JSON.stringify(error.response.data, null, 2));
    }
    throw new Error(`Google TTS ìƒì„± ì‹¤íŒ¨: ${error.message}`);
  }
};

// Gemini TTSëŠ” Google Cloud Text-to-Speech APIë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ë³„ë„ ì´ˆê¸°í™” ë¶ˆí•„ìš”
// googleTTSClientë¥¼ ê³µìœ í•©ë‹ˆë‹¤
console.log('[Gemini TTS] Using Google Cloud Text-to-Speech API (same as Google TTS)');

const generateGeminiTTS = async (text, options = {}) => {
  // Gemini TTSëŠ” Google Cloud Text-to-Speech APIë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤
  if (!googleTTSClient && !useRestAPI) {
    throw new Error('Gemini TTS not configured. Please set Google Cloud credentials.');
  }

  const {
    modelName = 'gemini-2.5-pro-tts',
    voiceName = 'Kore', // Available: Kore, Puck, Charon, Fenrir, Aoede, etc.
    voicePrompt = null, // Natural language prompt for voice control
    languageCode = 'ko-KR',
    audioEncoding = 'MP3'
  } = options;

  console.log(`[Gemini TTS] Generating audio for: "${text}"`);
  console.log(`[Gemini TTS] Model: ${modelName}, Voice: ${voiceName}`);
  if (voicePrompt) {
    console.log(`[Gemini TTS] Voice Prompt: "${voicePrompt}"`);
  }

  try {
    const request = {
      input: {
        text: text
      },
      voice: {
        languageCode: languageCode,
        name: voiceName,
        modelName: modelName // Gemini 2.5 Pro TTS
      },
      audioConfig: {
        audioEncoding: audioEncoding
      }
    };

    // í”„ë¡¬í”„íŠ¸ê°€ ìˆìœ¼ë©´ ì¶”ê°€
    if (voicePrompt) {
      request.input.prompt = voicePrompt;
    }

    if (useRestAPI) {
      // REST API ì‚¬ìš©
      const response = await axios.post(
        `https://texttospeech.googleapis.com/v1/text:synthesize?key=${googleAPIKey}`,
        request,
        {
          headers: {
            'Content-Type': 'application/json',
          },
          timeout: 30000
        }
      );

      console.log(`[Gemini TTS] Success (REST API) - Audio received`);
      return Buffer.from(response.data.audioContent, 'base64');
    } else {
      // Node.js í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©
      const [response] = await googleTTSClient.synthesizeSpeech(request);
      console.log(`[Gemini TTS] Success - Audio size: ${response.audioContent.length} bytes`);
      return response.audioContent;
    }
  } catch (error) {
    console.error('[Gemini TTS] Error:', error.message);
    if (error.response?.data) {
      console.error('[Gemini TTS] Error details:', JSON.stringify(error.response.data, null, 2));
    }
    throw new Error(`Gemini TTS ìƒì„± ì‹¤íŒ¨: ${error.message}`);
  }
};

const sanitizeTextForTTS = (text) => {
  if (!text || typeof text !== 'string') {
    return '';
  }
  
  // í…ìŠ¤íŠ¸ ê¸¸ì´ ì œí•œ (ElevenLabsëŠ” ë³´í†µ 5000ì ì œí•œ)
  let sanitized = text.trim().substring(0, 1000);
  
  // íŠ¹ìˆ˜ ë¬¸ì ë° HTML íƒœê·¸ ì œê±°
  sanitized = sanitized.replace(/<[^>]*>/g, ''); // HTML íƒœê·¸ ì œê±°
  sanitized = sanitized.replace(/[^\p{L}\p{N}\p{P}\p{S}\s]/gu, ''); // ìœ ë‹ˆì½”ë“œ ê¸°ë³¸ ë¬¸ìë§Œ ìœ ì§€
  
  // ì—°ì†ëœ ê³µë°± ì •ë¦¬
  sanitized = sanitized.replace(/\s+/g, ' ').trim();
  
  // ë¹ˆ ë¬¸ìì—´ì´ë©´ ê¸°ë³¸ í…ìŠ¤íŠ¸ ë°˜í™˜
  if (!sanitized) {
    sanitized = 'í…ìŠ¤íŠ¸ë¥¼ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
  }
  
  return sanitized;
};

const generateTTS = async (text, options = {}, retryCount = 0) => {
  const ELEVENLABS_API_KEY = process.env.ELEVENLABS_API_KEY;
  const maxRetries = 3;
  const {
    voiceId = process.env.VOICE_ID || 'pNInz6obpgDQGcFmaJgB',
    modelId = 'eleven_multilingual_v2', // v3ì—ì„œ v2ë¡œ ë³€ê²½ (ë” ì•ˆì •ì )
    stability = 0.5,
    similarityBoost = 0.5,
    speed = 1.0
  } = options;
  
  if (!ELEVENLABS_API_KEY) {
    throw new Error('ELEVENLABS_API_KEY environment variable is required');
  }

  // í…ìŠ¤íŠ¸ ì •ì œ
  const sanitizedText = sanitizeTextForTTS(text);
  
  // ë¡œê¹…
  console.log(`[TTS Request] Voice: ${voiceId}, Model: ${modelId}, Speed: ${speed}`);
  console.log(`[TTS Text] Original: "${text}" -> Sanitized: "${sanitizedText}"`);

  // ìš”ì²­ ë°ì´í„° ê²€ì¦
  if (!sanitizedText) {
    throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ í…ìŠ¤íŠ¸ì…ë‹ˆë‹¤.');
  }

  // íŒŒë¼ë¯¸í„° ë²”ìœ„ ê²€ì¦ (ElevenLabs API ì‹¤ì œ ì œí•œì‚¬í•­ ë°˜ì˜)
  const originalSpeed = speed;
  const validatedOptions = {
    stability: Math.max(0, Math.min(1, stability)),
    similarity_boost: Math.max(0, Math.min(1, similarityBoost)),
    speed: Math.max(0.7, Math.min(1.2, speed)) // ElevenLabs API ì‹¤ì œ ì œí•œ: 0.7-1.2
  };

  // ì†ë„ê°€ ì¡°ì •ë˜ì—ˆìœ¼ë©´ ë¡œê·¸
  if (originalSpeed !== validatedOptions.speed) {
    console.log(`[TTS Speed Adjustment] Original: ${originalSpeed} -> Validated: ${validatedOptions.speed}`);
  }

  const requestData = {
    text: sanitizedText,
    model_id: modelId,
    voice_settings: validatedOptions
  };

  console.log(`[TTS Payload]`, JSON.stringify(requestData, null, 2));

  try {
    const response = await axios.post(
      `https://api.elevenlabs.io/v1/text-to-speech/${voiceId}`,
      requestData,
      {
        headers: {
          'Accept': 'audio/mpeg',
          'Content-Type': 'application/json',
          'xi-api-key': ELEVENLABS_API_KEY
        },
        responseType: 'arraybuffer',
        timeout: 30000
      }
    );

    console.log(`[TTS Success] Audio generated successfully, size: ${response.data.byteLength} bytes`);
    return Buffer.from(response.data);
  } catch (error) {
    // ìƒì„¸í•œ ì—ëŸ¬ ë¡œê¹…
    console.error(`[TTS Error] Status: ${error.response?.status}, Message: ${error.message}`);
    console.error(`[TTS Error] Request URL: https://api.elevenlabs.io/v1/text-to-speech/${voiceId}`);
    console.error(`[TTS Error] Voice ID: ${voiceId}`);
    
    if (error.response?.data) {
      console.error(`[TTS Error] Response:`, error.response.data.toString());
    }
    
    // 400 ì—ëŸ¬ì— ëŒ€í•œ íŠ¹ë³„ ì²˜ë¦¬
    if (error.response?.status === 400) {
      const errorMessage = error.response.data ? error.response.data.toString() : 'Bad Request';
      console.error(`[TTS 400 Error] Bad request details: ${errorMessage}`);
      throw new Error(`TTS ìš”ì²­ ì˜¤ë¥˜ (400): ì˜ëª»ëœ íŒŒë¼ë¯¸í„° ë˜ëŠ” ìŒì„± ID. Voice ID: ${voiceId}, Model: ${modelId}`);
    }
    
    // 429 (Rate Limit) ë˜ëŠ” 503 (Service Unavailable) ì—ëŸ¬ ì‹œ ì¬ì‹œë„
    if ((error.response?.status === 429 || error.response?.status === 503) && retryCount < maxRetries) {
      const waitTime = Math.pow(2, retryCount) * 1000 + Math.random() * 1000;
      console.warn(`[TTS Retry] Rate limited, retrying in ${waitTime}ms (attempt ${retryCount + 1}/${maxRetries})`);
      await delay(waitTime);
      return generateTTS(text, options, retryCount + 1);
    }
    
    throw new Error(`TTS ìƒì„± ì‹¤íŒ¨ (${error.response?.status || 'Unknown'}): ${error.message}`);
  }
};

// ì‚¬ìš© ê°€ëŠ¥í•œ ìŒì„± ëª©ë¡ ì¡°íšŒ
app.get('/api/voices', async (req, res) => {
  const ELEVENLABS_API_KEY = process.env.ELEVENLABS_API_KEY;
  
  if (!ELEVENLABS_API_KEY) {
    return res.status(500).json({ error: 'ELEVENLABS_API_KEY not configured' });
  }

  try {
    console.log('[Voices API] Fetching available voices...');
    const response = await axios.get('https://api.elevenlabs.io/v1/voices', {
      headers: {
        'xi-api-key': ELEVENLABS_API_KEY
      },
      timeout: 10000
    });

    console.log(`[Voices API] Found ${response.data.voices?.length || 0} voices`);

    // ì‹¤ì œ ì‚¬ìš© ê°€ëŠ¥í•œ ìŒì„±ë“¤ ì¤‘ì—ì„œ ì„ ë³„
    let availableVoices = [];
    
    if (response.data.voices && Array.isArray(response.data.voices)) {
      // APIì—ì„œ ë°›ì€ ì‹¤ì œ ìŒì„±ë“¤ ì¤‘ ì¼ë¶€ ì„ íƒ
      const voiceMap = {};
      response.data.voices.forEach(voice => {
        voiceMap[voice.voice_id] = voice;
      });
      
      // í™•ì‹¤íˆ ì¡´ì¬í•˜ëŠ” ìŒì„±ë“¤ë§Œ ì‚¬ìš©
      const knownGoodVoices = [
        'pNInz6obpgDQGcFmaJgB', // Adam
        '21m00Tcm4TlvDq8ikWAM', // Rachel  
        'AZnzlk1XvdvUeBnXmlld', // Domi
        'EXAVITQu4vr4xnSDxMaL', // Bella
        'ErXwobaYiN019PkySvjV', // Antoni
      ];
      
      knownGoodVoices.forEach(voiceId => {
        if (voiceMap[voiceId]) {
          const voice = voiceMap[voiceId];
          availableVoices.push({
            id: voice.voice_id,
            name: `${voice.name} (${voice.labels?.gender || 'Unknown'})`,
            language: voice.labels?.language || 'en'
          });
        }
      });
      
      // APIì—ì„œ ë°›ì€ ìŒì„±ì´ ì—†ë‹¤ë©´ ìµœì†Œí•œì˜ ê¸°ë³¸ê°’ ì‚¬ìš©
      if (availableVoices.length === 0) {
        console.warn('[Voices API] No known voices found, using fallback');
        availableVoices = [
          { id: 'pNInz6obpgDQGcFmaJgB', name: 'Adam (Male)', language: 'en' }
        ];
      }
    } else {
      // API ì‘ë‹µì´ ì˜ˆìƒê³¼ ë‹¤ë¥¼ ë•Œ ê¸°ë³¸ê°’ ì‚¬ìš©
      availableVoices = [
        { id: 'pNInz6obpgDQGcFmaJgB', name: 'Adam (Male)', language: 'en' }
      ];
    }

    console.log(`[Voices API] Returning ${availableVoices.length} validated voices`);

    res.json({
      voices: availableVoices,
      models: [
        { id: 'eleven_multilingual_v2', name: 'Multilingual v2 (ì•ˆì •ì )', description: 'ì•ˆì •ì , ë‹¤êµ­ì–´ ì§€ì›' },
        { id: 'eleven_v3', name: 'Eleven v3 (ìµœê³ í’ˆì§ˆ)', description: 'ìµœê³ í’ˆì§ˆ, ìì—°ìŠ¤ëŸ¬ìš´ ìŒì„±' },
        { id: 'eleven_turbo_v2_5', name: 'Turbo v2.5 (ë¹ ë¦„)', description: 'ë¹ ë¥¸ ìƒì„±, ë‚®ì€ ì§€ì—°ì‹œê°„' },
        { id: 'eleven_flash_v2_5', name: 'Flash v2.5 (ì´ˆê³ ì†)', description: 'ì´ˆê³ ì†, ì‹¤ì‹œê°„ ì‘ìš©' }
      ]
    });
  } catch (error) {
    console.error('[Voices API Error]:', error.message);
    
    // ì—ëŸ¬ ì‹œ ê¸°ë³¸ ìŒì„± ëª©ë¡ ë°˜í™˜
    res.json({
      voices: [
        { id: 'pNInz6obpgDQGcFmaJgB', name: 'Adam (Male)', language: 'en' }
      ],
      models: [
        { id: 'eleven_multilingual_v2', name: 'Multilingual v2 (ì•ˆì •ì )', description: 'ì•ˆì •ì , ë‹¤êµ­ì–´ ì§€ì›' },
        { id: 'eleven_v3', name: 'Eleven v3 (ìµœê³ í’ˆì§ˆ)', description: 'ìµœê³ í’ˆì§ˆ, ìì—°ìŠ¤ëŸ¬ìš´ ìŒì„±' }
      ]
    });
  }
});

// Google TTS ìŒì„± ëª©ë¡ ì¡°íšŒ
app.get('/api/google-voices', async (req, res) => {
  console.log('========================================');
  console.log('[Google Voices API] ìš”ì²­ ë°›ìŒ');
  console.log('[Google Voices API] googleTTSClient:', googleTTSClient ? 'OK' : 'NULL');
  console.log('[Google Voices API] useRestAPI:', useRestAPI);
  console.log('[Google Voices API] googleAPIKey:', googleAPIKey ? `${googleAPIKey.substring(0, 10)}...` : 'NULL');
  console.log('========================================');

  if (!googleTTSClient && !useRestAPI) {
    console.error('[Google Voices API] âŒ ERROR: Google TTS not configured');
    return res.status(500).json({ error: 'Google TTS not configured' });
  }

  try {
    console.log('[Google Voices API] âœ… ìŒì„± ëª©ë¡ ì¡°íšŒ ì‹œì‘...');

    let koreanVoices = [];

    if (useRestAPI) {
      console.log('[Google Voices API] REST API ëª¨ë“œ ì‚¬ìš©');
      const url = `https://texttospeech.googleapis.com/v1/voices?key=${googleAPIKey}`;
      console.log('[Google Voices API] ìš”ì²­ URL:', url.replace(googleAPIKey, 'API_KEY_HIDDEN'));

      // REST APIë¡œ ìŒì„± ëª©ë¡ ì¡°íšŒ
      const response = await axios.get(url, {
        headers: {
          'Content-Type': 'application/json',
        },
        timeout: 10000
      });

      console.log('[Google Voices API] âœ… REST API ì‘ë‹µ ë°›ìŒ');
      console.log('[Google Voices API] ì „ì²´ ìŒì„± ê°œìˆ˜:', response.data.voices?.length || 0);

      // í•œêµ­ì–´ ìŒì„±ì„ íƒ€ì…ë³„ë¡œ ê·¸ë£¹í™”
      koreanVoices = response.data.voices
        .filter(voice => voice.languageCodes.includes('ko-KR'))
        .map(voice => ({
          id: voice.name,
          name: voice.name.replace('ko-KR-', ''),
          gender: voice.ssmlGender,
          type: voice.name.includes('Neural2') ? 'Neural2' :
                voice.name.includes('Wavenet') ? 'WaveNet' : 'Standard'
        }));
    } else {
      console.log('[Google Voices API] Node.js í´ë¼ì´ì–¸íŠ¸ ëª¨ë“œ ì‚¬ìš©');
      // Node.js í´ë¼ì´ì–¸íŠ¸ë¡œ ìŒì„± ëª©ë¡ ì¡°íšŒ
      const [result] = await googleTTSClient.listVoices({});

      console.log('[Google Voices API] âœ… í´ë¼ì´ì–¸íŠ¸ ì‘ë‹µ ë°›ìŒ');
      console.log('[Google Voices API] ì „ì²´ ìŒì„± ê°œìˆ˜:', result.voices?.length || 0);

      // í•œêµ­ì–´ ìŒì„±ì„ íƒ€ì…ë³„ë¡œ ê·¸ë£¹í™”
      koreanVoices = result.voices
        .filter(voice => voice.languageCodes.includes('ko-KR'))
        .map(voice => ({
          id: voice.name,
          name: voice.name.replace('ko-KR-', ''),
          gender: voice.ssmlGender,
          type: voice.name.includes('Neural2') ? 'Neural2' :
                voice.name.includes('Wavenet') ? 'WaveNet' : 'Standard'
        }));
    }

    console.log(`[Google Voices API] âœ… í•œêµ­ì–´ ìŒì„± ${koreanVoices.length}ê°œ ì°¾ìŒ`);

    // íƒ€ì…ë³„ë¡œ ê·¸ë£¹í™” (Gemini + Neural2ë§Œ ìœ ì§€)
    const voiceGroups = {
      gemini: {
        title: 'Gemini 2.5 Pro (ìµœì²¨ë‹¨)',
        description: 'ìì—°ì–´ í”„ë¡¬í”„íŒ…ìœ¼ë¡œ ìŠ¤íƒ€ì¼, í†¤, ê°ì • ì œì–´ ê°€ëŠ¥',
        quality: 6,
        pricing: 'ultra',
        supportsPrompting: true,
        voices: [
          { id: 'Puck', name: 'Puck', gender: 'NEUTRAL', type: 'Gemini', description: 'Upbeat' },
          { id: 'Charon', name: 'Charon', gender: 'NEUTRAL', type: 'Gemini', description: 'Deep' },
          { id: 'Kore', name: 'Kore', gender: 'NEUTRAL', type: 'Gemini', description: 'Firm' },
          { id: 'Fenrir', name: 'Fenrir', gender: 'NEUTRAL', type: 'Gemini', description: 'Strong' },
          { id: 'Aoede', name: 'Aoede', gender: 'NEUTRAL', type: 'Gemini', description: 'Melodic' },
          { id: 'Enceladus', name: 'Enceladus', gender: 'NEUTRAL', type: 'Gemini', description: 'Breathy' },
          { id: 'Sulafat', name: 'Sulafat', gender: 'NEUTRAL', type: 'Gemini', description: 'Warm' },
          { id: 'Draco', name: 'Draco', gender: 'NEUTRAL', type: 'Gemini', description: 'Stoic' },
          { id: 'Despina', name: 'Despina', gender: 'NEUTRAL', type: 'Gemini', description: 'Gentle' },
          { id: 'Zephyr', name: 'Zephyr', gender: 'NEUTRAL', type: 'Gemini', description: 'Soft' }
        ]
      },
      neural2: {
        title: 'Neural2 (ê³ í’ˆì§ˆ)',
        description: 'Custom Voice ê¸°ìˆ  ê¸°ë°˜, ìì—°ìŠ¤ëŸ¬ìš´ ìŒì„±',
        quality: 5,
        pricing: 'premium',
        supportsPrompting: false,
        voices: koreanVoices.filter(v => v.type === 'Neural2')
      }
    };

    console.log('[Google Voices API] âœ… ì‘ë‹µ ì „ì†¡ ì¤€ë¹„ ì™„ë£Œ');
    res.json({
      voiceGroups: voiceGroups,
      pricing: {
        freeQuota: {
          gemini: 'Vertex AI ìš”ê¸ˆì œì— ë”°ë¼ ë‹¤ë¦„',
          neural2: 'ì›” 100ë§Œ ë¬¸ì'
        },
        paidRates: {
          gemini: 'Vertex AI ìš”ê¸ˆì œ ì°¸ê³ ',
          neural2: '100ë§Œ ë¬¸ìë‹¹ $16'
        }
      },
      audioEncodings: ['MP3', 'WAV', 'OGG'],
      speakingRateRange: { min: 0.25, max: 4.0 },
      pitchRange: { min: -20.0, max: 20.0 },
      volumeRange: { min: -96.0, max: 16.0 }
    });
    console.log('[Google Voices API] âœ…âœ…âœ… ì‘ë‹µ ì „ì†¡ ì™„ë£Œ!');
  } catch (error) {
    console.error('========================================');
    console.error('[Google Voices API] âŒâŒâŒ ERROR ë°œìƒ!');
    console.error('[Google Voices API] Error Type:', error.constructor.name);
    console.error('[Google Voices API] Error Message:', error.message);
    console.error('[Google Voices API] Error Stack:', error.stack);
    if (error.response) {
      console.error('[Google Voices API] HTTP Status:', error.response.status);
      console.error('[Google Voices API] Response Data:', JSON.stringify(error.response.data, null, 2));
    }
    console.error('========================================');
    
    // ì—ëŸ¬ ì‹œ ê¸°ë³¸ ìŒì„± ëª©ë¡ ë°˜í™˜ (2024ë…„ ìµœì‹  ì •ë³´ ë°˜ì˜)
    res.json({
      voiceGroups: {
        gemini: {
          title: 'Gemini 2.5 Pro (ìµœì²¨ë‹¨)',
          description: 'ìì—°ì–´ í”„ë¡¬í”„íŒ…ìœ¼ë¡œ ìŠ¤íƒ€ì¼, í†¤, ê°ì • ì œì–´ ê°€ëŠ¥',
          quality: 6,
          pricing: 'ultra',
          supportsPrompting: true,
          voices: [
            { id: 'Puck', name: 'Puck', gender: 'NEUTRAL', type: 'Gemini', description: 'Upbeat' },
            { id: 'Charon', name: 'Charon', gender: 'NEUTRAL', type: 'Gemini', description: 'Deep' },
            { id: 'Kore', name: 'Kore', gender: 'NEUTRAL', type: 'Gemini', description: 'Firm' },
            { id: 'Fenrir', name: 'Fenrir', gender: 'NEUTRAL', type: 'Gemini', description: 'Strong' },
            { id: 'Aoede', name: 'Aoede', gender: 'NEUTRAL', type: 'Gemini', description: 'Melodic' },
            { id: 'Enceladus', name: 'Enceladus', gender: 'NEUTRAL', type: 'Gemini', description: 'Breathy' },
            { id: 'Sulafat', name: 'Sulafat', gender: 'NEUTRAL', type: 'Gemini', description: 'Warm' },
            { id: 'Draco', name: 'Draco', gender: 'NEUTRAL', type: 'Gemini', description: 'Stoic' },
            { id: 'Despina', name: 'Despina', gender: 'NEUTRAL', type: 'Gemini', description: 'Gentle' },
            { id: 'Zephyr', name: 'Zephyr', gender: 'NEUTRAL', type: 'Gemini', description: 'Soft' }
          ]
        },
        neural2: {
          title: 'Neural2 (ê³ í’ˆì§ˆ)',
          description: 'Custom Voice ê¸°ìˆ  ê¸°ë°˜, ê°€ì¥ ìì—°ìŠ¤ëŸ¬ìš´ ìŒì„±',
          quality: 5,
          pricing: 'premium',
          supportsPrompting: false,
          voices: [
            { id: 'ko-KR-Neural2-A', name: 'Neural2-A', gender: 'FEMALE', type: 'Neural2' },
            { id: 'ko-KR-Neural2-B', name: 'Neural2-B', gender: 'MALE', type: 'Neural2' },
            { id: 'ko-KR-Neural2-C', name: 'Neural2-C', gender: 'FEMALE', type: 'Neural2' },
            { id: 'ko-KR-Neural2-D', name: 'Neural2-D', gender: 'MALE', type: 'Neural2' }
          ]
        }
      },
      pricing: {
        freeQuota: {
          gemini: 'Vertex AI ìš”ê¸ˆì œì— ë”°ë¼ ë‹¤ë¦„',
          neural2: 'ì›” 100ë§Œ ë¬¸ì'
        },
        paidRates: {
          gemini: 'Vertex AI ìš”ê¸ˆì œ ì°¸ê³ ',
          neural2: '100ë§Œ ë¬¸ìë‹¹ $16'
        }
      },
      audioEncodings: ['MP3', 'WAV', 'OGG'],
      speakingRateRange: { min: 0.25, max: 4.0 },
      pitchRange: { min: -20.0, max: 20.0 },
      volumeRange: { min: -96.0, max: 16.0 }
    });
  }
});

// Google TTS ìŒì„± ë¯¸ë¦¬ë³´ê¸°
app.post('/api/google-preview', async (req, res) => {
  if (!googleTTSClient) {
    return res.status(500).json({ error: 'Google TTS not configured' });
  }

  try {
    const { voiceId, previewText = "ì•ˆë…•í•˜ì„¸ìš”. ì´ê²ƒì€ ìŒì„± ë¯¸ë¦¬ë³´ê¸°ì…ë‹ˆë‹¤." } = req.body;
    
    console.log(`[Google Preview] Voice: ${voiceId}, Text: "${previewText}"`);
    
    const audioBuffer = await generateGoogleTTS(previewText, {
      voiceName: voiceId,
      speakingRate: 1.0,
      pitch: 0.0,
      volumeGainDb: 0.0,
      audioEncoding: 'MP3'
    });
    
    res.json({
      success: true,
      audioData: audioBuffer.toString('base64'),
      voiceId: voiceId,
      text: previewText
    });
    
  } catch (error) {
    console.error('[Google Preview Error]:', error.message);
    res.status(500).json({ error: `ë¯¸ë¦¬ë³´ê¸° ìƒì„± ì‹¤íŒ¨: ${error.message}` });
  }
});

// Google TTS ë¬¸ì¥ ì²˜ë¦¬
app.post('/api/google-process-sentences', async (req, res) => {
  try {
    const { rawSentences, voiceOptions = {} } = req.body;

    console.log(`[Google Process] Starting processing for ${rawSentences?.length || 0} sentences`);
    console.log(`[Google Process] Voice options:`, JSON.stringify(voiceOptions, null, 2));

    if (!Array.isArray(rawSentences) || rawSentences.length === 0) {
      return res.status(400).json({ error: 'rawSentences must be a non-empty array' });
    }

    // Gemini ìŒì„±ì¸ì§€ Google TTS ìŒì„±ì¸ì§€ í™•ì¸
    const voiceName = voiceOptions.voiceName || 'ko-KR-Neural2-A';
    const isGeminiVoice = !voiceName.includes('ko-KR-');

    console.log(`[Google Process] Voice type: ${isGeminiVoice ? 'Gemini' : 'Google TTS'}`);

    // Gemini TTSë„ Google Cloud Text-to-Speech APIë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ë™ì¼í•œ í´ë¼ì´ì–¸íŠ¸ í™•ì¸
    if (!googleTTSClient && !useRestAPI) {
      return res.status(500).json({ error: 'Google TTS not configured' });
    }

    // ê° ë¬¸ì¥ì„ ë³‘ë ¬ë¡œ ì²˜ë¦¬
    const processPromises = rawSentences.map(async (sentence, index) => {
      const trimmedSentence = sentence.trim();
      if (!trimmedSentence) {
        return {
          id: index + 1,
          original: sentence,
          corrected: sentence,
          translation: sentence,
          audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
          error: 'Empty sentence'
        };
      }

      try {
        // ìŒì„± íƒ€ì…ì— ë”°ë¼ ì ì ˆí•œ TTS í•¨ìˆ˜ ì„ íƒ
        const ttsFunction = isGeminiVoice ?
          () => generateGeminiTTS(trimmedSentence, {
            modelName: voiceOptions.modelName || 'gemini-2.5-pro-tts',
            voiceName: voiceName,
            voicePrompt: voiceOptions.voicePrompt || null,
            languageCode: voiceOptions.languageCode || 'ko-KR'
          }) :
          () => generateGoogleTTS(trimmedSentence, voiceOptions);

        // ê° ì‘ì—…ì„ ê°œë³„ì ìœ¼ë¡œ ì²˜ë¦¬
        const [spellResult, translationResult, ttsResult] = await Promise.allSettled([
          spellCheck(trimmedSentence),
          translateText(trimmedSentence),
          ttsFunction()
        ]);

        const corrected = spellResult.status === 'fulfilled' ? spellResult.value : trimmedSentence;
        const translation = translationResult.status === 'fulfilled' ? translationResult.value : `[ë²ˆì—­ ì‹¤íŒ¨] ${trimmedSentence}`;

        if (ttsResult.status === 'fulfilled') {
          return {
            id: index + 1,
            original: trimmedSentence,
            corrected: corrected,
            translation: translation,
            audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
            binaryData: ttsResult.value.toString('base64')
          };
        } else {
          return {
            id: index + 1,
            original: trimmedSentence,
            corrected: corrected,
            translation: translation,
            audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
            error: `ì˜¤ë””ì˜¤ ìƒì„± ì‹¤íŒ¨: ${ttsResult.reason?.message || 'Unknown error'}`
          };
        }
      } catch (error) {
        console.error(`Unexpected error processing sentence ${index + 1}:`, error.message);
        return {
          id: index + 1,
          original: trimmedSentence,
          corrected: trimmedSentence,
          translation: `[ë²ˆì—­ ì‹¤íŒ¨] ${trimmedSentence}`,
          audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
          error: `ì²˜ë¦¬ ì‹¤íŒ¨: ${error.message}`
        };
      }
    });

    // ëª¨ë“  ë¬¸ì¥ ì²˜ë¦¬ ì™„ë£Œê¹Œì§€ ëŒ€ê¸°
    const results = await Promise.allSettled(processPromises);

    // ê²°ê³¼ ì •ë¦¬
    const finalResults = results.map((result, index) => {
      if (result.status === 'fulfilled') {
        return result.value;
      } else {
        return {
          id: index + 1,
          original: rawSentences[index],
          corrected: rawSentences[index],
          translation: rawSentences[index],
          audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
          error: `ì²˜ë¦¬ ì‹¤íŒ¨: ${result.reason?.message || 'Unknown error'}`
        };
      }
    });

    res.json(finalResults);
  } catch (error) {
    console.error('Google TTS Server error:', error.message);
    res.status(500).json({ error: 'Internal server error' });
  }
});

app.post('/api/process-sentences', async (req, res) => {
  try {
    const { rawSentences, voiceOptions = {} } = req.body;
    
    console.log(`[Process] Starting processing for ${rawSentences?.length || 0} sentences`);
    console.log(`[Process] Voice options:`, JSON.stringify(voiceOptions, null, 2));
    
    if (!Array.isArray(rawSentences) || rawSentences.length === 0) {
      return res.status(400).json({ error: 'rawSentences must be a non-empty array' });
    }

    // ê° ë¬¸ì¥ì„ ë³‘ë ¬ë¡œ ì²˜ë¦¬
    const processPromises = rawSentences.map(async (sentence, index) => {
      const trimmedSentence = sentence.trim();
      if (!trimmedSentence) {
        return {
          id: index + 1,
          original: sentence,
          corrected: sentence,
          translation: sentence,
          audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
          error: 'Empty sentence'
        };
      }

      try {
        // ê° ì‘ì—…ì„ ê°œë³„ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì¼ë¶€ ì‹¤íŒ¨í•´ë„ ë‹¤ë¥¸ ì‘ì—…ì€ ì„±ê³µí•  ìˆ˜ ìˆë„ë¡
        const [spellResult, translationResult, ttsResult] = await Promise.allSettled([
          spellCheck(trimmedSentence),
          translateText(trimmedSentence),
          generateTTS(trimmedSentence, voiceOptions)
        ]);
        
        const corrected = spellResult.status === 'fulfilled' ? spellResult.value : trimmedSentence;
        const translation = translationResult.status === 'fulfilled' ? translationResult.value : `[ë²ˆì—­ ì‹¤íŒ¨] ${trimmedSentence}`;
        
        if (ttsResult.status === 'fulfilled') {
          return {
            id: index + 1,
            original: trimmedSentence,
            corrected: corrected,
            translation: translation,
            audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
            binaryData: ttsResult.value.toString('base64')
          };
        } else {
          return {
            id: index + 1,
            original: trimmedSentence,
            corrected: corrected,
            translation: translation,
            audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
            error: `ì˜¤ë””ì˜¤ ìƒì„± ì‹¤íŒ¨: ${ttsResult.reason?.message || 'Unknown error'}`
          };
        }
      } catch (error) {
        console.error(`Unexpected error processing sentence ${index + 1}:`, error.message);
        return {
          id: index + 1,
          original: trimmedSentence,
          corrected: trimmedSentence,
          translation: `[ë²ˆì—­ ì‹¤íŒ¨] ${trimmedSentence}`,
          audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
          error: `ì²˜ë¦¬ ì‹¤íŒ¨: ${error.message}`
        };
      }
    });

    // ëª¨ë“  ë¬¸ì¥ ì²˜ë¦¬ ì™„ë£Œê¹Œì§€ ëŒ€ê¸°
    const results = await Promise.allSettled(processPromises);
    
    // ê²°ê³¼ ì •ë¦¬
    const finalResults = results.map((result, index) => {
      if (result.status === 'fulfilled') {
        return result.value;
      } else {
        return {
          id: index + 1,
          original: rawSentences[index],
          corrected: rawSentences[index],
          translation: rawSentences[index],
          audioFileName: `sentence_${String(index + 1).padStart(2, '0')}.mp3`,
          error: `Processing failed: ${result.reason?.message || 'Unknown error'}`
        };
      }
    });

    res.json(finalResults);
  } catch (error) {
    console.error('Server error:', error.message);
    res.status(500).json({ error: 'Internal server error' });
  }
});

app.listen(PORT, () => {
  console.log(`Server running on http://localhost:${PORT}`);
});
</file>

<file path=".env.example">
ELEVENLABS_API_KEY=your_elevenlabs_api_key_here
VOICE_ID=pNInz6obpgDQGcFmaJgB

# Google Cloud TTS ì„¤ì • (ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ì„¤ì •)
# ë°©ë²• 1: ì„œë¹„ìŠ¤ ê³„ì • í‚¤ íŒŒì¼ ê²½ë¡œ
GOOGLE_APPLICATION_CREDENTIALS=/path/to/your/service-account-key.json

# ë°©ë²• 2: Google Cloud Project ID (ê¸°ë³¸ ì¸ì¦ ì‚¬ìš©)
GOOGLE_CLOUD_PROJECT=your-google-cloud-project-id

PORT=3000
</file>

<file path="package.json">
{
  "name": "nomorerecording",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node src/server.js",
    "dev": "node src/server.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "type": "commonjs",
  "dependencies": {
    "@google-cloud/text-to-speech": "^6.4.0",
    "@google/generative-ai": "^0.24.1",
    "axios": "^1.13.2",
    "cors": "^2.8.5",
    "dotenv": "^17.2.3",
    "express": "^5.1.0",
    "form-data": "^4.0.5",
    "jszip": "^3.10.1",
    "multer": "^2.0.2"
  }
}
</file>

<file path="README.md">
# í•œêµ­ì–´ í•™ìŠµìš© ìŒì„± ìƒì„± ì›¹ì„œë¹„ìŠ¤

í•œêµ­ì–´ í•™ìŠµìë¥¼ ìœ„í•´ ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥ë°›ì•„, ì •ì œëœ ë¬¸ì¥ ë°ì´í„°ì™€ ê³ í’ˆì§ˆ TTS ì˜¤ë””ì˜¤ íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ì›¹ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

## ğŸµ ì§€ì›í•˜ëŠ” TTS ì„œë¹„ìŠ¤

### ğŸ™ï¸ ElevenLabs
- ì´ˆê³ í’ˆì§ˆ ìì—°ìŠ¤ëŸ¬ìš´ ìŒì„±
- 70ê°œ ì´ìƒ ì–¸ì–´ ì§€ì›
- ê°ì • í‘œí˜„ ë° ì–µì–‘ ì¡°ì ˆ
- ë‹¤ì–‘í•œ ìŒì„± ìŠ¤íƒ€ì¼

### ğŸŒ Google Cloud TTS
- Neural2 & WaveNet ê³ í’ˆì§ˆ ìŒì„±
- SSML ë§ˆí¬ì—… ì§€ì›ìœ¼ë¡œ ê³ ê¸‰ ì œì–´
- ê²½ì œì ì¸ ê°€ê²© ì •ì±…
- ì•ˆì •ì ì¸ êµ¬ê¸€ í´ë¼ìš°ë“œ ì¸í”„ë¼

## ğŸš€ ê¸°ëŠ¥

- **ë§ì¶¤ë²• êµì •**: ë¶€ì‚°ëŒ€í•™êµ ë§ì¶¤ë²• ê²€ì‚¬ê¸° + ëŒ€ì²´ ì„œë¹„ìŠ¤
- **ë‹¤ì¤‘ ë²ˆì—­**: MyMemory + LibreTranslate API
- **ë³‘ë ¬ ì²˜ë¦¬**: ëª¨ë“  ë¬¸ì¥ ë™ì‹œ ì²˜ë¦¬ë¡œ ë¹ ë¥¸ ì„±ëŠ¥
- **ì˜¤ë””ì˜¤ í”Œë ˆì´**: ë¸Œë¼ìš°ì €ì—ì„œ ë°”ë¡œ ì¬ìƒ
- **ZIP ë‹¤ìš´ë¡œë“œ**: ëª¨ë“  ì˜¤ë””ì˜¤ + í…ìŠ¤íŠ¸ íŒŒì¼ ì¼ê´„ ë‹¤ìš´ë¡œë“œ
- **SSML ì§€ì›**: Google TTSì—ì„œ ê³ ê¸‰ ìŒì„± ì œì–´

## ğŸ“¦ ì„¤ì¹˜ ë° ì‹¤í–‰

1. **ì˜ì¡´ì„± ì„¤ì¹˜**:
```bash
npm install
```

2. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**:
```bash
cp .env.example .env
```

`.env` íŒŒì¼ì„ ì—´ê³  API í‚¤ë¥¼ ì„¤ì •í•˜ì„¸ìš”:

### ElevenLabs ì„¤ì • (ì„ íƒ)
```env
ELEVENLABS_API_KEY=your_elevenlabs_api_key_here
VOICE_ID=pNInz6obpgDQGcFmaJgB
```

### Google Cloud TTS ì„¤ì • (ì„ íƒ, ë‘˜ ì¤‘ í•˜ë‚˜)
```env
# ë°©ë²• 1: ì„œë¹„ìŠ¤ ê³„ì • í‚¤ íŒŒì¼
GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account-key.json

# ë°©ë²• 2: í”„ë¡œì íŠ¸ ID (gcloud auth ì‚¬ìš©)
GOOGLE_CLOUD_PROJECT=your-project-id
```

3. **ì„œë²„ ì‹¤í–‰**:
```bash
npm start
```

4. **ë¸Œë¼ìš°ì € ì ‘ì†**: `http://localhost:3000`

## ğŸ›ï¸ API ì—”ë“œí¬ì¸íŠ¸

### ElevenLabs
- `GET /api/voices` - ì‚¬ìš© ê°€ëŠ¥í•œ ìŒì„± ëª©ë¡
- `POST /api/process-sentences` - ë¬¸ì¥ ì²˜ë¦¬

### Google TTS
- `GET /api/google-voices` - Google ìŒì„± ëª©ë¡
- `POST /api/google-process-sentences` - Google TTSë¡œ ë¬¸ì¥ ì²˜ë¦¬

### ê³µí†µ ìš”ì²­ í˜•ì‹
```json
{
  "rawSentences": [
    "ì•ˆë…•í•˜ì„¸ìš”. í•œêµ­ì–´ë¥¼ ë°°ìš°ê³  ìˆìŠµë‹ˆë‹¤.",
    "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì •ë§ ì¢‹ë„¤ìš”!"
  ],
  "voiceOptions": {
    // ElevenLabs ì˜µì…˜
    "voiceId": "pNInz6obpgDQGcFmaJgB",
    "modelId": "eleven_multilingual_v2",
    "speed": 1.0,
    "stability": 0.5,
    "similarityBoost": 0.5,
    
    // Google TTS ì˜µì…˜
    "voiceName": "ko-KR-Neural2-A",
    "speakingRate": 1.0,
    "pitch": 0.0,
    "volumeGainDb": 0.0,
    "ssmlText": "<speak>íŠ¹ë³„í•œ <emphasis>ê°•ì¡°</emphasis></speak>"
  }
}
```

## ğŸ”‘ API í‚¤ íšë“ ë°©ë²•

### ElevenLabs
1. https://elevenlabs.io/ ê°€ì…
2. ëŒ€ì‹œë³´ë“œì—ì„œ API í‚¤ ë°œê¸‰
3. `.env`ì— `ELEVENLABS_API_KEY` ì„¤ì •

### Google Cloud TTS
1. [Google Cloud Console](https://console.cloud.google.com/) ì ‘ì†
2. ìƒˆ í”„ë¡œì íŠ¸ ìƒì„± ë˜ëŠ” ê¸°ì¡´ í”„ë¡œì íŠ¸ ì„ íƒ
3. Cloud Text-to-Speech API í™œì„±í™”
4. ì„œë¹„ìŠ¤ ê³„ì • í‚¤ ìƒì„± ë˜ëŠ” gcloud CLI ì¸ì¦
5. `.env`ì— ì¸ì¦ ì •ë³´ ì„¤ì •

## ğŸ¨ SSML ì˜ˆì œ (Google TTS)

```xml
<speak>
  ì•ˆë…•í•˜ì„¸ìš”! <break time="1s"/>
  <emphasis level="strong">ì¤‘ìš”í•œ</emphasis> ë‚´ìš©ì…ë‹ˆë‹¤.
  <prosody rate="slow" pitch="+2st">ì²œì²œíˆ ë†’ì€ í†¤ìœ¼ë¡œ</prosody>
</speak>
```

## ğŸ› ï¸ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

- Node.js 16.0 ì´ìƒ
- npm ë˜ëŠ” yarn
- ì¸í„°ë„· ì—°ê²° (ì™¸ë¶€ API ì‚¬ìš©)

## ğŸ“Š ì„±ëŠ¥ íŠ¹ì§•

- **ë³‘ë ¬ ì²˜ë¦¬**: ë¬¸ì¥ë³„ + APIë³„ ë™ì‹œ ì²˜ë¦¬
- **ì—ëŸ¬ ë³µêµ¬**: API ì‹¤íŒ¨ ì‹œ ìë™ ì¬ì‹œë„ ë° ëŒ€ì²´ ì„œë¹„ìŠ¤
- **ë©”ëª¨ë¦¬ íš¨ìœ¨**: ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ë¡œ ëŒ€ìš©ëŸ‰ í…ìŠ¤íŠ¸ ì§€ì›
</file>

</files>
